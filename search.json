[{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Estimating the ADRF with *adrftools*","text":"adrftools contains functions support effect estimation, inference, visualization continuous (.e., non-discrete) treatments. primary estimand continuous treatment average dose-response function (ADRF), \\[ \\theta_\\text{ADRF}() = E[Y()] \\]\\(Y()\\) potential outcome treatment value \\(\\) \\(E[.]\\) expectation operator, taken distribution covariates \\(X\\) population, \\(Y() = h_a(X)\\) function \\(h_a()\\). Unlike categorical treatments treatment effect can understood contrast expected potential outcomes fixed treatment levels, effect continuous treatment function, makes interpreting communicating challenging. adrftools aims simplify tasks allowing rich understanding relationship studied. certain causal assumptions met data study design, ADRF can identified \\[ E[Y()]=E_X\\left[E[Y|=,X]\\right] \\]Much effort causal inference literature finding consistent estimators function. often quite challenging addition requiring knowledge relationship \\(X\\) \\(\\) \\(X\\) \\(Y\\) (), requires knowledge relationship \\(\\) \\(Y\\). categorical treatments, latter relationship direct. Popular methods adjusting \\(X\\) estimating ADRF include weighting, g-computation, doubly-robust approaches. See Zhang et al. (2016) review methods. full characterization ADRF can involve multiple steps. Often, ADRF correspond directly set coefficients outcome model. Rather, must computed treatment value outcome model parameters using g-computation. means simply writing ADRF function parameters either impossible fail provide interpretable information effect treatment. solutions problem: one visualize ADRF plot. Another project simpler function onto ADRF interpretable summary; strategy described Neugebauer Laan (2007). adrftools provides functionality strategies. One may also want perform inference ADRF answer substantive questions, whether ADRF flat, whether ADRF linear, whether slope linear projection ADRF nonzero. Inference ADRF can challenging, multiple sources uncertainty must accounted , including sampling population, estimation weights balance covariates, estimation outcome model parameters. adrftools offers methods account uncertainty performing inference ADRF.","code":""},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"effect-curves","dir":"Articles","previous_headings":"Introduction","what":"Effect Curves","title":"Estimating the ADRF with *adrftools*","text":"ADRF one variety functions call “effect curves”, functions treatment. following effect curves available adrftools: subgroup ADRF (\\(G\\) grouping variable \\(g\\) level \\(G\\)): \\[\\theta_{\\text{ADRF},g}() = E\\left[Y()|G=g\\right]\\] average marginal effect function (AMEF), defined derivative ADRF: \\[\\theta_\\text{AMEF}() = \\frac{d\\theta_\\text{ADRF}(a_0)}{da_0}\\Bigr|_{a_0 = }\\] reference effect curve, defined contrast point effect curve (\\(\\theta()\\)) given (fixed) value curve (\\(\\theta(')\\)): \\[\\theta_\\text{ref}(; ') = \\theta() - \\theta(')\\] effect curve contrast, defined contrast effect curves computed within subgroups \\(G=g_1\\) \\(G=g_2\\): \\[\\theta_\\text{contr}(; g_1, g_2) = \\theta_{g_1}() - \\theta_{g_2}()\\] linear functions ADRF, means can account uncertainty ADRF, can account uncertainty effect curves derived .","code":""},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"this-guide","dir":"Articles","previous_headings":"Introduction","what":"This Guide","title":"Estimating the ADRF with *adrftools*","text":"guide, walk standard analysis, demonstrating can use adrftools perform tasks . First ’ll load adrftools using library(). follows, ’ll describe dataset used tutorial help files package functions. Next, ’ll describe basics package used construct, visualize, perform inference ADRF. Next ’ll discuss effect curves, finally scenarios require special attention (non-continuous outcome, multiply imputed data, sampling balancing weights).","code":"library(adrftools)"},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"the-data","dir":"Articles","previous_headings":"","what":"The Data","title":"Estimating the ADRF with *adrftools*","text":"data use guide nhanes3lead dataset comes adrftools. data subset NHANES III survey. estimate characterize effect blood lead levels cognitive test scores, adjusting potential confounders. treatment variables logBLL, natural log blood lead levels μg/dL, analysis, use Math outcome variable, score WISC Math test. Covariates include Age, Male, Race, PIR, Enough_Food, Smoke_in_Home, Smoke_Pregnant, NICU.","code":"data(\"nhanes3lead\")  head(nhanes3lead) #>         Age Male     Race   PIR Enough_Food Smoke_in_Home Smoke_Pregnant NICU #> 1 10.583333    0    White 1.266           1             0              0    0 #> 2  7.166667    0    Black 0.603           1             1              1    0 #> 3 11.916667    0 Hispanic 3.173           1             0              0    0 #> 4  6.583333    1    White 1.543           1             1              0    0 #> 5  8.250000    0    White 3.043           1             0              0    0 #> 6  8.250000    1    Other 1.746           1             1              0    0 #>       logBLL Math Reading Block Digit   MEC_wt #> 1 -0.3566749   10       8    12     7  7785.67 #> 2  2.0014800   13       9     8    12 11001.98 #> 3  1.3609766    6      10    11     7  7024.62 #> 4  1.1631508    6       5     8     5  7901.41 #> 5  0.7419373    8       9    14     8  9997.87 #> 6  1.3609766   12      10    11     8 11979.76"},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"analysis","dir":"Articles","previous_headings":"","what":"Analysis","title":"Estimating the ADRF with *adrftools*","text":"use g-computation estimate ADRF logBLL Math adjusting covariates. also possible use weighted g-computation propensity score weighting alone adjust covariates; demonstrate section “Additional Scenarios”. procedure essentially . use adrftools answer following research questions: ADRF look like? ADRF flat? ADRF linear? linear projection ADRF? slope zero? expected difference Math scores low high level blood lead exposure?","code":""},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"fitting-the-outcome-model","dir":"Articles","previous_headings":"Analysis","what":"Fitting the outcome model","title":"Estimating the ADRF with *adrftools*","text":"first step fit outcome model. model interpreted flexible enough capture nonlinear relationships, especially treatment outcome. adrftools supports model also supported marginaleffects, performance improved models fit lm() glm(). , use lm() fit linear regression Math logBLL, covariates, interaction. supply logBLL natural cubic spline 5 degrees freedom capture potential nonlinearities using splines::ns(). also allow full ADRF vary across levels Male allow us examine sex differences later. won’t even look model; none coefficients interpretable. Instead, ’ll use functions adrftools characterize ADRF perform inference .","code":"fit <- lm(Math ~ splines::ns(logBLL, df = 5) * Male *             (Age + Race + PIR + Enough_Food + Smoke_in_Home +                Smoke_Pregnant + NICU),           data = nhanes3lead)"},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"computing-and-plotting-the-adrf","dir":"Articles","previous_headings":"Analysis","what":"Computing and plotting the ADRF","title":"Estimating the ADRF with *adrftools*","text":"compute ADRF, supply outcome model adrf(), also requires name treatment supplied treat. ADRF evaluated range treatment values. range can controlled range argument adrf(). default, range middle 95% treatment values, case corresponds values -0.3567 2.4248. important know range inferences made generalize treatment values range. Typically, values edges observed treatment range estimated less certainty, values beyond observed treatment range involve extrapolation. adrf() also provides options uncertainty estimation using vcov argument. default, vcov = \"unconditional\", uses M-estimation account uncertainty estimation sampling analytically described Hansen Overgaard (2024); requires model object estfun() bread() methods. Setting vcov = \"boot\" vcov = \"fwb\" use traditional fractional weighted bootstrap (Xu et al. 2020), respectively, implemented fwb; also account sampling estimation uncertainty. Finally, argument vcov argument marginaleffects::vcov() can supplied perform conditional inference (.e., treating sample fixed); “default” variance can requested setting vcov = \"conditional\" (typically just uses vcov() method model object). output adrf() <effect_curve> object. Printing object displays information effect curve. <effect_curve> object function takes values treatment returns estimates ADRF points. example, display ADRF estimates values logBLL equal 0, 1, 2, can run following: Perhaps useful summary effect curve plot, can produce simply running plot() <effect_curve> object:  x-axis treatment y-axis value ADRF treatment level (labeled \\(\\text{E[Math]}\\)). solid red line ADRF pink ribbon 95% uniform confidence band. default, confidence bands computed providing uniform coverage, meaning nominal rate refers simultaneous coverage points line rather single given point (Montiel Olea Plagborg-Møller 2019). Pointwise confidence bands can instead requested setting simultaneous = FALSE call plot(). generally recommended overstates precision estimated ADRF. confidence level can set conf_level, bootstrapping used adrf(), method computing confidence interval can controlled ci.type argument, passed fwb::summary.fwb(). Simultaneous coverage possible ci.type \"perc\" (percentile confidence intervals, default bootstrapping) \"wald\". compute confidence intervals around specific points ADRF, one can use summary() output <effect_curve> object: summary() accepts arguments plot() control confidence interval coverage whether inference simultaneous. Unlike plot(), summary(), simultaneous inference accounts estimates requested, full effect curve. Points along ADRF can contrasted pairwise using point_contrast() output <effect_curve> object (using summary() output): addition contrast estimates confidence intervals, test statistics p-values tests contrasts equal 0 displayed. Null value note table indicates null value used tests.","code":"adrf_bll <- adrf(fit, treat = \"logBLL\") adrf_bll #> An <effect_curve> object #>  #>  - curve type: ADRF #>  - response: Math #>  - treatment: logBLL #>    + range: -0.3567 to 2.4248 #>  - inference: unconditional adrf_bll(logBLL = c(0, 1, 2)) #>  ADRF Estimates #> ──────────────── #>  logBLL Estimate #>       0    8.421 #>       1    8.025 #>       2    7.146 #> ──────────────── plot(adrf_bll) adrf_bll(logBLL = c(0, 1, 2)) |>   summary() #>               ADRF Estimates #> ────────────────────────────────────────── #>  logBLL Estimate Std. Error CI Low CI High #>       0    8.421     0.1678  8.021   8.822 #>       1    8.025     0.1124  7.757   8.293 #>       2    7.146     0.2162  6.630   7.661 #> ────────────────────────────────────────── #> Inference: unconditional, simultaneous #> Confidence level: 95% (t* = 2.386, df = 2401) adrf_bll(logBLL = c(0, 1, 2)) |>   point_contrast() |>   summary() #>                           ADRF Point Contrasts #> ──────────────────────────────────────────────────────────────────────── #>                         Term Estimate Std. Error      t  P-value  CI Low #>  [logBLL = 1] - [logBLL = 0]  -0.3964     0.2127 -1.863   0.1476 -0.8938 #>  [logBLL = 2] - [logBLL = 0]  -1.2757     0.2800 -4.556 < 0.0001 -1.9305 #>  [logBLL = 2] - [logBLL = 1]  -0.8793     0.2642 -3.328   0.0025 -1.4972 #> ──────────────────────────────────────────────────────────────────────── #> Inference: unconditional, simultaneous #> Confidence level: 95% (t* = 2.338, df = 2401) #> Null value: 0"},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"testing-the-adrf","dir":"Articles","previous_headings":"Analysis","what":"Testing the ADRF","title":"Estimating the ADRF with *adrftools*","text":"test omnibus hypotheses ADRF, whether flat linear, can use summary() <effect_curve> object , rather output. particular, summary() tests whether given projection ADRF sufficient characterize . projection determined argument hypothesis. default, \"flat\", tests null hypothesis ADRF flat. hypothesis rejected, implies effect treatment. test works two steps: first, projection \\(\\hat{P}()\\) computed, second, residuals projection used compute test statistic. test statistic \\(T\\) defined \\[ T=\\int_{a_\\text{low}}^{a_\\text{high}} {\\left(\\hat{\\theta}() - \\hat{P}() \\right)^2 da} \\] \\(\\hat{\\theta}()\\) ADRF estimate treatment value \\(\\) \\(a_\\text{low}\\) \\(a_\\text{high}\\) lower upper bounds treatment domain, respectively. ADRF perfectly flat, \\(T=0\\) difference ADRF flat projection 0. possible compute cumulative distribution function (CDF) \\(T\\) null hypothesis true ADRF equal specified projection, CDF used compute p-value along test statistic \\(T\\) computed sample. several methods approximating CDF, choice controlled method argument summary(): Monte Carlo simulation distribution \\(T\\) null hypothesis (method = \"sim\") Analytic approximation using functionality CompQuadForm package (method = \"imhof\", \"davies\", \"liu\") Satterthwaite’s approximation based moment matching \\(\\chi^2\\) distribution (method = \"satterthwaite\") Kuonen’s saddlepoint approximation using functionality survey package (method = \"saddlepoint\") method = \"imhof\" method = \"sim\" reliable. former fast deterministic, used default CompQuadForm package installed. latter slower subject Monte Carlo error, require additional packages. method = \"saddlepoint\" performs well, , used default CompQuadForm package installed survey package . hypothesis can also \"linear\", \"quadratic\", \"cubic\", formula representing projection test. Rejecting null hypothesis indicates ADRF complicated supplied model; example, rejecting null hypothesis hypothesis = \"linear\" means ADRF nonlinear, failing reject null hypothesis hypothesis = \"quadratic\" means enough evidence claim ADRF complicated quadratic model. Rejecting hypotheses also rejects null hypothesis lower-order model, including \"flat\". Finally, hypothesis can single number, indicating null hypothesis ADRF flat equal value. Typically, useful testing effect curves natural null value (e.g., 0). example , p-value test ADRF flat range listed less .0001, can reject null hypothesis line flat therefore claim effect logBLL Math. can also test whether ADRF approximately linear: case, high p-value indicates reject null hypothesis ADRF linear, even though appears curve plot. can interpret indicating linear ADRF consistent data, , precisely, isn’t evidence ADRF nonlinear. ’s important interpret tests within range listed test output. possible ADRF different shape beyond range, possible including different range change results test. example, including parts ADRF estimated less precision can make whole test less precise.","code":"summary(adrf_bll) #>                   Omnibus Curve Test #> ─────────────────────────────────────────────────────── #> H₀: ADRF is flat for values of logBLL between -0.3567 #>     and 2.4248 #>  #>   P-value #>  < 0.0001 #> ─────────────────────────────────────────────────────── #> Computed using the Imhof approximation summary(adrf_bll, hypothesis = \"linear\") #>                   Omnibus Curve Test #> ─────────────────────────────────────────────────────── #> H₀: ADRF is linear for values of logBLL between #>     -0.3567 and 2.4248 #>  #>  P-value #>    0.478 #> ─────────────────────────────────────────────────────── #> Computed using the Imhof approximation"},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"estimating-a-linear-projection","dir":"Articles","previous_headings":"Analysis","what":"Estimating a linear projection","title":"Estimating the ADRF with *adrftools*","text":"Though characterized, visualized, tested ADRF flexible way, may use finding simpler representation can used interpretable summary. unable reject null hypothesis ADRF linear, can try projecting ADRF onto linear model easily interpret form slope intercept. also allow us make firmer statement magnitude direction effect logBLL Math. don’t need re-fit outcome model; outcome model correspond ADRF conditional model, whereas ADRF marginalizes distribution covariates. Instead, can use curve_projection() perform projection. curve_projection() takes <effect_curve> object projection model includes treatment. model can form, case, makes sense supply simple linear model. value can supplied hypothesis summary() can supplied model argument curve_projection(), essentially fits linear regression effect curve estimates treatment values correctly accounts uncertainty effect curve estimates estimating uncertainty projection model parameters. projection formed minimizing loss function \\[ \\int_{a_\\text{low}}^{a_\\text{high}}{\\left(\\hat{\\theta}()-\\hat{P}()\\right)^2 \\,da} \\] \\(\\hat{P}()\\) projection model evaluated treatment value \\(\\). requesting linear projection, \\[ \\hat{P}()=\\hat b_0 + \\hat b_1 \\] , fit linear projection using curve_projection(): output summary() similar applied <lm> object; can see coefficient estimates, standard errors, tests, confidence intervals. expected, find negative slope significant .001 level, indicating increase logBLL corresponds decrease average Math scores. can plot projection either alone top ADRF plot. plot alone, can simply use plot() curve_projection() output:  plot similar interpretation ADRF plot. add projection original estimated ADRF plot, can supply curve_projection() output proj argument plot() applied original <effect_curve> object:  dotted line projection, solid line shaded region correspond original ADRF estimate original ADRF estimate’s confidence bands. Two nested projection models can compared Wald test using anova(), just typical linear models.","code":"proj <- curve_projection(adrf_bll, \"linear\")  summary(proj) #>                  ADRF Projection Coefficients #> ────────────────────────────────────────────────────────────── #>         Term Estimate Std. Error     t  P-value CI Low CI High #>  (Intercept)    8.486     0.1322 64.18 < 0.0001  8.226   8.745 #>       logBLL   -0.613     0.1267 -4.84 < 0.0001 -0.861  -0.364 #> ────────────────────────────────────────────────────────────── #> Inference: unconditional #> Confidence level: 95% (t* = 1.961, df = 2401) #> Null value: 0 plot(proj) plot(adrf_bll, proj = proj)"},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"other-effect-curves","dir":"Articles","previous_headings":"Analysis","what":"Other effect curves","title":"Estimating the ADRF with *adrftools*","text":"learn effect treatment outcome ADRF alone can provide. effect curves help us answer substantive questions effect. , ’ll describe computing reference effect curves, average marginal effect function (AMEF), subgroup ADRFs, contrasts subgroup ADRFs. steps use ADRF building block.","code":""},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"reference-effect-curves","dir":"Articles","previous_headings":"Analysis > Other effect curves","what":"Reference effect curves","title":"Estimating the ADRF with *adrftools*","text":"reference effect curve function representing contrast ADRF ADRF single level treatment. example, one may interested characterizing effect treatment difference ADRF nonzero treatment values ADRF treatment set 0, Hill (2011). compute reference effect curve ADRF, can supply ADRF reference_curve(), supplying argument reference corresponding level treatment use reference. , set reference 0 (arbitrary example treatment log scale). produces <reference_curve> object, , printed, displays reference level. can plot reference curve, essentially original ADRF shifted curve height reference level equal 0.  Notice confidence bands narrow close treatment levels close reference level; greater certainty ADRF deviations value reference level region. can use summary() test whether reference curve equal 0 everywhere, tests whether ADRF differs value reference level: Theoretically, equivalent testing whether ADRF flat (matter reference level set ), though may slight differences results test test flatness applied directly ADRF. can test whether individual values ADRF differ value ADRF reference level calling summary() output <reference_curve> object applied desired treatment levels: output, can see value ADRF logBLL = 1.5 differs logBLL = 0 tiny p-value. note table indicates value reference null value hypothesis tests.","code":"adrf_bll_ref <- reference_curve(adrf_bll, reference = 0) adrf_bll_ref #> An <effect_curve> object #>  #>  - curve type: ADRF reference #>  - response: Math #>  - treatment: logBLL #>    + range: -0.3567 to 2.4248 #>  - reference level: 0 #>  - inference: unconditional plot(adrf_bll_ref) summary(adrf_bll_ref) #>                   Omnibus Curve Test #> ─────────────────────────────────────────────────────── #> H₀: ADRF difference from reference (logBLL = 0) is 0 #>     for values of logBLL between -0.3567 and 2.4248 #>  #>   P-value #>  < 0.0001 #> ─────────────────────────────────────────────────────── #> Computed using the Imhof approximation adrf_bll_ref(logBLL = c(.5, 1, 1.5)) |>   summary() #>                  ADRF Reference Estimates #> ─────────────────────────────────────────────────────────── #>  logBLL Estimate Std. Error      t  P-value  CI Low CI High #>     0.5  -0.1113     0.1466 -0.760   0.7642 -0.4528  0.2301 #>     1.0  -0.3964     0.2127 -1.863   0.1452 -0.8918  0.0990 #>     1.5  -0.9598     0.2205 -4.354 < 0.0001 -1.4732 -0.4464 #> ─────────────────────────────────────────────────────────── #> Inference: unconditional, simultaneous #> Confidence level: 95% (t* = 2.329, df = 2401) #> Reference: logBLL = 0 | Null value: 0"},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"the-amef","dir":"Articles","previous_headings":"Analysis > Other effect curves","what":"The AMEF","title":"Estimating the ADRF with *adrftools*","text":"AMEF derivative ADRF. level abstraction away ADRF, can challenging interpret. point AMEF represents instantaneous effect treatment outcome. AMEF 0, ADRF flat. adrftools, amef() can used compute AMEF supplying <effect_curve> object. result <amef_curve> object, , like <effect_curve> objects, function. can plot AMEF plot().  Unlike plotting ADRF, plotting AMEF automatically includes horizontal line y-intercept 0. can controlled null argument plot(). can compute estimates AMEF specific values supplying values <amef_curve> object using summary() examine output: , p-value test AMEF value equal 0 displayed along confidence intervals. null value test can controlled null argument summary(). Testing whether AMEF uniformly equal 0 theoretically equivalent testing whether ADRF flat. can perform test using summary() <amef_curve> object . default value hypothesis 0 test whether AMEF 0 everywhere. Conclusions test ADRF flat AMEF 0 may differ due differing sensitivities local alternatives tests. research needed understand differences. now, recommend using test AMEF instead testing flatness ADRF directly.","code":"amef_bll <- amef(adrf_bll)  amef_bll #> An <effect_curve> object #>  #>  - curve type: AMEF #>  - response: Math #>  - treatment: logBLL #>    + range: -0.3567 to 2.4248 #>  - inference: unconditional plot(amef_bll) amef_bll(c(0, 1, 2)) |>   summary() #>                       AMEF Estimates #> ─────────────────────────────────────────────────────────── #>  logBLL Estimate Std. Error       t P-value  CI Low CI High #>       0  -0.0982     0.5166 -0.1902  0.9965 -1.3313  1.1348 #>       1  -0.8166     0.6597 -1.2378  0.5133 -2.3911  0.7579 #>       2  -0.1605     0.6479 -0.2478  0.9923 -1.7068  1.3858 #> ─────────────────────────────────────────────────────────── #> Inference: unconditional, simultaneous #> Confidence level: 95% (t* = 2.387, df = 2401) #> Null value: 0 summary(amef_bll) #>                   Omnibus Curve Test #> ─────────────────────────────────────────────────────── #> H₀: AMEF is 0 for values of logBLL between -0.3567 and #>     2.4248 #>  #>  P-value #>   0.3528 #> ─────────────────────────────────────────────────────── #> Computed using the Imhof approximation"},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"subgroup-adrfs","dir":"Articles","previous_headings":"Analysis > Other effect curves","what":"Subgroup ADRFs","title":"Estimating the ADRF with *adrftools*","text":"ADRF can computed within subgroups probe effect treatment different unit profiles. compute ADRF subgroup, one can simply use subset argument adrf() one call lm(). supplied argument subset evaluate logical vector using data fit original model. , compute ADRF logBLL group Male == 0. functionality full-sample ADRFs can used subgroup ADRF.  ’s also possible compute ADRF multiple subgroups simultaneously. , one can use argument adrf(), accepts one-sided formula subgrouping variables right side. Printing stratified <effect_curve> object displays variables supplied : plot ADRF, can see curves groups:  Indeed, functions operate ADRF estimates produce results subgroups. , test null hypotheses ADRF subgroup flat: can reject null hypothesis Male = 1 group, Male = 0 group .05 level. can display ADRF estimates subgroup supplying values treatment <effect_curve> object calling summary() output: Columns subgrouping variables displayed left. project ADRFs onto linear model, also get separate projection coefficients subgroup:   Note corrections multiple comparisons simultaneous = TRUE plot() summary() made accounting subgroups, can quickly escalate additional estimates within subgroups. display results subset subgroups, plot(), <effect_curve> object, summary() accept subset argument works like supplied adrf(), operates subgroup estimates included <effect_curve> object argument. example, plot subgroups separately, can use following:","code":"adrf_bll_male_0 <- adrf(fit, treat = \"logBLL\",                         subset = Male == 0) plot(adrf_bll_male_0) adrf_bll_by_male <- adrf(fit, treat = \"logBLL\",                          by = ~Male) adrf_bll_by_male #> An <effect_curve> object #>  #>  - curve type: ADRF #>  - response: Math #>  - treatment: logBLL #>    + range: -0.3567 to 2.4248 #>  - by: Male #>  - inference: unconditional plot(adrf_bll_by_male) summary(adrf_bll_by_male) #>                   Omnibus Curve Test #> ─────────────────────────────────────────────────────── #> H₀: ADRF is flat for values of logBLL between -0.3567 #>     and 2.4248 #>  #>  Male  P-value #>     0   0.0667 #>     1 < 0.0001 #> ─────────────────────────────────────────────────────── #> Computed using the Imhof approximation adrf_bll_by_male(logBLL = c(0, 1, 2)) |>   summary() #>                 ADRF Estimates #> ─────────────────────────────────────────────── #>  Male logBLL Estimate Std. Error CI Low CI High #>     0      0    8.469     0.2351  7.850   9.088 #>     0      1    8.460     0.1523  8.059   8.861 #>     0      2    7.619     0.3274  6.757   8.480 #>     1      0    8.375     0.2392  7.746   9.005 #>     1      1    7.605     0.1641  7.173   8.036 #>     1      2    6.689     0.2833  5.943   7.434 #> ─────────────────────────────────────────────── #> Inference: unconditional, simultaneous #> Confidence level: 95% (t* = 2.631, df = 2401) proj_by_male <- curve_projection(adrf_bll_by_male, \"linear\")  # Coefficient estimates summary(proj_by_male) #>                    ADRF Projection Coefficients #> ─────────────────────────────────────────────────────────────────── #>  Male        Term Estimate Std. Error     t  P-value CI Low CI High #>     0 (Intercept)    8.623     0.1867 46.18 < 0.0001  8.256   8.989 #>     0      logBLL   -0.441     0.1863 -2.37   0.0180 -0.806  -0.076 #>     1 (Intercept)    8.353     0.1871 44.65 < 0.0001  7.986   8.720 #>     1      logBLL   -0.779     0.1720 -4.53 < 0.0001 -1.116  -0.441 #> ─────────────────────────────────────────────────────────────────── #> Inference: unconditional #> Confidence level: 95% (t* = 1.961, df = 2401) #> Null value: 0  # Projection plot plot(proj_by_male) # ADRF plot with projection plot(adrf_bll_by_male, proj = proj_by_male)"},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"section","dir":"Articles","previous_headings":"","what":"Estimating the ADRF with *adrftools*","title":"Estimating the ADRF with *adrftools*","text":"Male = 0 Male = 1","code":"plot(adrf_bll_by_male, subset = Male == 0) plot(adrf_bll_by_male, subset = Male == 1)"},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"section-1","dir":"Articles","previous_headings":"","what":"Estimating the ADRF with *adrftools*","title":"Estimating the ADRF with *adrftools*","text":"produces output plotting ADRF computed supplying subset adrf() arguments. can functions well:","code":""},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"section-2","dir":"Articles","previous_headings":"","what":"Estimating the ADRF with *adrftools*","title":"Estimating the ADRF with *adrftools*","text":"Male = 0 Male = 1","code":"# Testing whether the ADRF is flat summary(adrf_bll_by_male, subset = Male == 0) #>                   Omnibus Curve Test #> ─────────────────────────────────────────────────────── #> H₀: ADRF is flat for values of logBLL between -0.3567 #>     and 2.4248 #>  #>  Male P-value #>     0  0.0667 #> ─────────────────────────────────────────────────────── #> Computed using the Imhof approximation  # Estimates along the ADRF adrf_bll_by_male(logBLL = c(0, 1, 2), subset = Male == 0) |>   summary() #>                 ADRF Estimates #> ─────────────────────────────────────────────── #>  Male logBLL Estimate Std. Error CI Low CI High #>     0      0    8.469     0.2351  7.908   9.030 #>     0      1    8.460     0.1523  8.096   8.823 #>     0      2    7.619     0.3274  6.837   8.400 #> ─────────────────────────────────────────────── #> Inference: unconditional, simultaneous #> Confidence level: 95% (t* = 2.386, df = 2401) # Testing whether the ADRF is flat summary(adrf_bll_by_male, subset = Male == 1) #>                   Omnibus Curve Test #> ─────────────────────────────────────────────────────── #> H₀: ADRF is flat for values of logBLL between -0.3567 #>     and 2.4248 #>  #>  Male  P-value #>     1 < 0.0001 #> ─────────────────────────────────────────────────────── #> Computed using the Imhof approximation  # Estimates along the ADRF adrf_bll_by_male(logBLL = c(0, 1, 2), subset = Male == 1) |>   summary() #>                 ADRF Estimates #> ─────────────────────────────────────────────── #>  Male logBLL Estimate Std. Error CI Low CI High #>     1      0    8.375     0.2392  7.804   8.946 #>     1      1    7.605     0.1640  7.213   7.996 #>     1      2    6.689     0.2833  6.012   7.365 #> ─────────────────────────────────────────────── #> Inference: unconditional, simultaneous #> Confidence level: 95% (t* = 2.386, df = 2401)"},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"section-3","dir":"Articles","previous_headings":"","what":"Estimating the ADRF with *adrftools*","title":"Estimating the ADRF with *adrftools*","text":"Notice critical \\(t\\) value (displayed t* output) differs examining estimates within subgroup including subgroups adjustment value simultaneous inference smaller fewer estimates.","code":""},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"subgroup-adrf-contrasts","dir":"Articles","previous_headings":"Analysis > Other effect curves","what":"Subgroup ADRF contrasts","title":"Estimating the ADRF with *adrftools*","text":"used compute ADRF within subgroups, compute new effect curve corresponding contrast subgroup ADRFs. Using curve_contrast() produces <contrast_curve> object, <effect_curve> object. Printing object displays contrast(s) computed. two subgroups, pairs subgroups compared. can plot difference two ADRFs using plot():  , y-axis corresponds difference subgroup ADRF estimates, horizontal line 0 displayed. can use summary() test whether ADRF contrast curve equal 0 everywhere, indicate ADRF differ across subgroups: Given small p-value, can reject null hypothesis ADRF contrast 0, implying subgroup ADRFs differ . can use summary() output <contrast_curve> object test differences subgroup ADRFs specific points: see evidence ADRF values logBLL = 1 differ Male = 1 Male = 0 subgroups.","code":"adrf_bll_male_contrast <- curve_contrast(adrf_bll_by_male) adrf_bll_male_contrast #> An <effect_curve> object #>  #>  - curve type: ADRF contrast #>  - response: Math #>  - treatment: logBLL #>    + range: -0.3567 to 2.4248 #>  - contrast: [Male = 1] - [Male = 0] #>  - inference: unconditional plot(adrf_bll_male_contrast) summary(adrf_bll_male_contrast) #>                   Omnibus Curve Test #> ─────────────────────────────────────────────────────── #> H₀: ADRF contrast is 0 for values of logBLL between #>     -0.3567 and 2.4248 #>  #>                 Contrast P-value #>  [Male = 1] - [Male = 0]    0.01 #> ─────────────────────────────────────────────────────── #> Computed using the Imhof approximation adrf_bll_male_contrast(logBLL = c(0, 1, 2)) |>   summary() #>                          ADRF Contrast Estimates #> ────────────────────────────────────────────────────────────────────────── #>                 Contrast logBLL Estimate Std. Error      t P-value  CI Low #>  [Male = 1] - [Male = 0]      0  -0.0938     0.3354 -0.280  0.9890 -0.8942 #>  [Male = 1] - [Male = 0]      1  -0.8551     0.2239 -3.820  0.0004 -1.3892 #>  [Male = 1] - [Male = 0]      2  -0.9300     0.4329 -2.148  0.0914 -1.9631 #> ────────────────────────────────────────────────────────────────────────── #> Inference: unconditional, simultaneous #> Confidence level: 95% (t* = 2.386, df = 2401) #> Null value: 0"},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"additional-scenarios","dir":"Articles","previous_headings":"","what":"Additional Scenarios","title":"Estimating the ADRF with *adrftools*","text":", demonstrated basic use adrftools linear outcome model. Often, analyses complicated. example, might scenario missing data, survey weights, inverse probability weighting, nonlinear models, etc. , briefly explain modify procedures deal issues.","code":""},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"nonlinear-outcome-models","dir":"Articles","previous_headings":"Additional Scenarios","what":"Nonlinear outcome models","title":"Estimating the ADRF with *adrftools*","text":"outcome binary, may use logistic regression fit outcome model instead linear model. adds additional complication many procedures adrftools assume linearity quantities analyzed. general, though, adrftools works smoothly nonlinear models, generalized linear models. , demonstrate differences dealing models. outcome, use binarized version Block, Block_bin, 1 Block 12 greater 0 otherwise. ’ll create variable use outcome outcome model: compute ADRF, simply call adrf(). can supply type argument, specifies type prediction use. default, type = \"response\", computes ADRF probability scale, natural binary outcome. can plot ADRF plot():  important thing notice confidence bands asymmetrical. symmetrical Wald confidence bands first computed transformed versions ADRF estimates back-transformed original scale. isn’t computing ADRF linear predictor outcome model (.e., specifying type = \"link\" call adrf()); involves computing ADRF usual original (probability scale), transforming ADRF estimates, using delta method compute variance transformed estimates, computing Wald confidence bands using variance transformed estimates back-transforming1. ensures confidence bands respect bounds implied link function used outcome model. instead compute symmetric confidence bands around original ADRF estimates, one can specify transform = FALSE plot(). produces ADRF line, confidence bands symmetrical around , means possible confidence bands fall outside 0 1, :","code":"nhanes3lead$Block_bin <- as.integer(nhanes3lead$Block >= 12)  table(nhanes3lead$Block_bin) #>  #>    0    1  #> 2049  472  fit_bin <- glm(Block_bin ~ splines::ns(logBLL, df = 5) *                  (Age + Male + Race + PIR + Enough_Food + Smoke_in_Home +                     Smoke_Pregnant + NICU),                data = nhanes3lead,                family = binomial) adrf_bll_bin <- adrf(fit_bin, treat = \"logBLL\")  adrf_bll_bin #> An <effect_curve> object #>  #>  - curve type: ADRF #>  - response: Block_bin #>  - treatment: logBLL #>    + range: -0.3567 to 2.4248 #>  - inference: unconditional plot(adrf_bll_bin)"},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"section-4","dir":"Articles","previous_headings":"","what":"Estimating the ADRF with *adrftools*","title":"Estimating the ADRF with *adrftools*","text":"Transformed Untransformed","code":"plot(adrf_bll_bin) plot(adrf_bll_bin, transform = FALSE)"},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"section-5","dir":"Articles","previous_headings":"","what":"Estimating the ADRF with *adrftools*","title":"Estimating the ADRF with *adrftools*","text":"Bootstrapping using percentile confidence bands avoids issue bands invariant transformation respect bounds outcome. summary() applied ADRF point estimates also transform argument purpose; default, computes transformed confidence intervals.","code":""},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"section-6","dir":"Articles","previous_headings":"","what":"Estimating the ADRF with *adrftools*","title":"Estimating the ADRF with *adrftools*","text":"Transformed Untransformed","code":"adrf_bll_bin(logBLL = c(0, 1, 2)) |>   summary() #>         ADRF Estimates #> ─────────────────────────────── #>  logBLL Estimate CI Low CI High #>       0   0.2420 0.1930  0.2988 #>       1   0.1925 0.1602  0.2296 #>       2   0.0752 0.0396  0.1383 #> ─────────────────────────────── #> Inference: unconditional, simultaneous #> Confidence level: 95% (z* = 2.386) adrf_bll_bin(logBLL = c(0, 1, 2)) |>   summary(transform = FALSE) #>               ADRF Estimates #> ────────────────────────────────────────── #>  logBLL Estimate Std. Error CI Low CI High #>       0   0.2420     0.0222 0.1890  0.2949 #>       1   0.1925     0.0145 0.1579  0.2272 #>       2   0.0752     0.0198 0.0279  0.1225 #> ────────────────────────────────────────── #> Inference: unconditional, simultaneous #> Confidence level: 95% (z* = 2.386)"},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"section-7","dir":"Articles","previous_headings":"","what":"Estimating the ADRF with *adrftools*","title":"Estimating the ADRF with *adrftools*","text":"transform = FALSE, standard errors displayed; otherwise, omitted computed standard errors transformed estimates. Note regardless transform, estimates confidence intervals reported scale original prediction type (case, probabilities). transform changes confidence intervals computed. transform can TRUE, FALSE, <family> object, function. TRUE (default adrftools functions use ), link function outcome model used. <family> object supplied, link function used. function supplied, used transformation. Typically transformation function takes input estimate outcome scale (e.g., probabilities binary outcomes) returns quantity unbounded scale; examples include qlogis() qnorm() binary outcomes (corresponding logistic probit links) log() count outcomes. projecting ADRF onto simpler model, one option specifying projection either transformation linear predictor linear predictor (.e., untransformed). example, binary outcome logistic transformation, specifying projection transformation yield logistic (S-shaped) curve, whereas specifying projection linear predictor yield straight line. transformation \\(g(\\mu)\\) inverse \\(g^{-1}(\\eta)\\) (e.g., \\(g(\\mu) = \\log{\\frac{\\mu}{1-\\mu}}\\) \\(g^{-1}(\\eta) = \\frac{1}{1 + \\exp(-\\eta)}\\)), transformed projection estimated minimizing \\[ \\int_{a_\\text{low}}^{a_\\text{high}}{\\left(\\hat{\\theta}()-g^{-1}\\left(\\hat{P}()\\right)\\right)^2 \\,da} \\] \\(\\hat{P}()\\) linear predictor projection model evaluated treatment value \\(\\) (e.g., \\(\\hat{P}()=\\hat{b}_0 + \\hat{b}_1 \\) simple linear projection model). projection estimated using nonlinear least-squares, propagation uncertainty ADRF carried using delta method. choice whether use transformed projection untransformed projection affects output summary() curve_projection(), involve projection ADRF. transformation requested summary() (default), null hypothesis tested whether ADRF sufficiently described transformed linear predictor. example, consider scenario true ADRF S-shaped. Testing whether ADRF linear without transformation corresponds testing whether ADRF complicated straight line, therefore likely yield rejection null hypothesis (.e., straight line sufficient characterize S-shaped ADRF). Testing whether ADRF linear transformation corresponds testing whether ADRF complicated S-shaped curve, therefore likely yield failure reject null hypothesis (.e., S-shaped curve sufficient characterize ADRF). correct choice depends specifics research question context. testing whether ADRF flat, test using transformed linear predictor typically equivalent using linear predictor ; ideally tests yield conclusion. testing whether ADRF equal given value, test back-transforms ADRF estimate given value computing test statistic. tabbed output , run summary() curve_projection() without transformation:","code":""},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"section-8","dir":"Articles","previous_headings":"","what":"Estimating the ADRF with *adrftools*","title":"Estimating the ADRF with *adrftools*","text":"Transformed Untransformed","code":"# Test for flatness summary(adrf_bll_bin) #>                   Omnibus Curve Test #> ─────────────────────────────────────────────────────── #> H₀: ADRF is flat (transformed) for values of logBLL #>     between -0.3567 and 2.4248 #>  #>   P-value #>  < 0.0001 #> ─────────────────────────────────────────────────────── #> Computed using the Imhof approximation  # Test for linearity summary(adrf_bll_bin, \"linear\") #>                   Omnibus Curve Test #> ─────────────────────────────────────────────────────── #> H₀: ADRF is linear (transformed) for values of logBLL #>     between -0.3567 and 2.4248 #>  #>  P-value #>    0.144 #> ─────────────────────────────────────────────────────── #> Computed using the Imhof approximation  # Estimate projection on transformed ADRF proj_t <- curve_projection(adrf_bll_bin, \"linear\")  summary(proj_t) #>                   ADRF Projection Coefficients #> ───────────────────────────────────────────────────────────────── #>         Term Estimate Std. Error       z  P-value  CI Low CI High #>  (Intercept)  -1.0964     0.0941 -11.653 < 0.0001 -1.2808  -0.912 #>       logBLL  -0.5373     0.0996  -5.392 < 0.0001 -0.7325  -0.342 #> ───────────────────────────────────────────────────────────────── #> Inference: unconditional #> Confidence level: 95% (z* = 1.96) #> Null value: 0 # Test for flatness summary(adrf_bll_bin, transform = FALSE) #>                   Omnibus Curve Test #> ─────────────────────────────────────────────────────── #> H₀: ADRF is flat for values of logBLL between -0.3567 #>     and 2.4248 #>  #>   P-value #>  < 0.0001 #> ─────────────────────────────────────────────────────── #> Computed using the Imhof approximation  # Test for linearity summary(adrf_bll_bin, \"linear\", transform = FALSE) #>                   Omnibus Curve Test #> ─────────────────────────────────────────────────────── #> H₀: ADRF is linear for values of logBLL between #>     -0.3567 and 2.4248 #>  #>  P-value #>   0.5193 #> ─────────────────────────────────────────────────────── #> Computed using the Imhof approximation  # Estimate projection on untransformed ADRF proj_u <- curve_projection(adrf_bll_bin, \"linear\", transform = FALSE)  summary(proj_u) #>                   ADRF Projection Coefficients #> ──────────────────────────────────────────────────────────────── #>         Term Estimate Std. Error      z  P-value  CI Low CI High #>  (Intercept)   0.2497     0.0162 15.396 < 0.0001  0.2179  0.2815 #>       logBLL  -0.0788     0.0133 -5.936 < 0.0001 -0.1048 -0.0528 #> ──────────────────────────────────────────────────────────────── #> Inference: unconditional #> Confidence level: 95% (z* = 1.96) #> Null value: 0"},{"path":[]},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"section-10","dir":"Articles","previous_headings":"","what":"Estimating the ADRF with *adrftools*","title":"Estimating the ADRF with *adrftools*","text":"Transformed Untransformed","code":"# Plot transformed projection plot(proj_t)  plot(adrf_bll_bin, proj = proj_t) # Plot untransformed projection plot(proj_u)  plot(adrf_bll_bin, proj = proj_u)"},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"section-11","dir":"Articles","previous_headings":"","what":"Estimating the ADRF with *adrftools*","title":"Estimating the ADRF with *adrftools*","text":"Notice projections appear someone different depending whether transformation requested. (default), projection coefficients interpreted like generalized linear model outcome treatment transformation given link function (case, log odds scale). projection curved reflect nonlinear relationship implied transformation. , projection coefficients interpreted directly though fitted linear model, projection linear. Transformed projections may realistic respecting scale outcome, coefficients can harder interpret. example , untransformed linear projection appear fit ADRF slightly better; reasonable say observed treatment range, ADRF can sufficiently described linear. However, knowing outcome bounded 0 1, know ADRF linear across entirety real number line.","code":""},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"balancing-weights","dir":"Articles","previous_headings":"Additional Scenarios","what":"Balancing weights","title":"Estimating the ADRF with *adrftools*","text":"G-computation typically requires unlikely conditions met order effective adjusting confounding. conditions can weakened first weighting sample treatment independent covariates. weighting, one can either use g-computation weighted sample simply fit unconditional dose-response function without adjusting covariates, case estimated dose-response function corresponds ADRF. adrftools can handle weighted samples straightforward way. Nothing needs change previous scenarios; issue concerned need refit weighting model bootstrapping uncertainty estimation. Fortunately, functionality WeightIt makes straightforward. using WeightIt estimate weights, one can use one WeightIt’s built-outcome modeling functions like glm_weightit() fit outcome model. See example , first estimate balancing weights using generalized propensity score weighting. Normally, assess balance weights, ’ll skip (see vignette(\"cobalt\", package = \"cobalt\") details ). ’ll use glm_weightit() fit linear model Math, incorporating estimation weights variance outcome model parameters. Finally, can use adrf() compute ADRF, just output lm().","code":"library(WeightIt)  w_fit <- weightit(logBLL ~ Male + Age + Race + PIR + Enough_Food +                     Smoke_in_Home + Smoke_Pregnant + NICU,                   data = nhanes3lead,                   method = \"glm\")  w_fit #> A weightit object #>  - method: \"glm\" (propensity score weighting with GLM) #>  - number of obs.: 2521 #>  - sampling weights: none #>  - treatment: continuous #>  - covariates: Male, Age, Race, PIR, Enough_Food, Smoke_in_Home, Smoke_Pregnant, NICU fit <- glm_weightit(Math ~ splines::ns(logBLL, df = 5) *                       (Age + Male + Race + PIR + Enough_Food + Smoke_in_Home +                          Smoke_Pregnant + NICU),                     data = nhanes3lead,                     weightit = w_fit) adrf_bll_w <- adrf(fit, treat = \"logBLL\")  plot(adrf_bll_w)"},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"sampling-weights","dir":"Articles","previous_headings":"Additional Scenarios","what":"Sampling weights","title":"Estimating the ADRF with *adrftools*","text":"Sampling weights can bit complicated balancing weights; addition using weights fit outcome model, sampling weights need incorporated g-computation procedure estimate ADRF. outcome models fit survey::svyglm(), special operation required—sampling weights automatically incorporated estimation variance estimates. sampling weights used another model included model, wts argument adrf() needs specified. wts can TRUE use weights used fit outcome model, string containing name variable original dataset containing sampling weights, vector sampling weights. general, ’s best use model automatically incorporates sampling weights; wts typically specified. nhanes3lead dataset, MEC_wt variable contains sampling weights. , ’ll demonstrate three common approaches incorporating sampling weights: 1) using survey::svyglm(), 2) using s.weights argument WeightIt::weightit(), 3) using weights argument glm(); last three requires using wts argument.","code":""},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"using-survey","dir":"Articles","previous_headings":"Additional Scenarios > Sampling weights","what":"Using survey","title":"Estimating the ADRF with *adrftools*","text":"First, ’ll use survey functionality incorporate sampling weights. Simply calling adrf() automatically incorporates sampling weights.","code":"library(survey)  des <- svydesign(~1, weights = ~MEC_wt, data = nhanes3lead)  fit_sv <- svyglm(Math ~ splines::ns(logBLL, df = 5) *                    (Age + Male + Race + PIR + Enough_Food + Smoke_in_Home +                       Smoke_Pregnant + NICU),                  design = des) adrf_sv <- adrf(fit_sv, treat = \"logBLL\")  plot(adrf_sv)"},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"using-glm","dir":"Articles","previous_headings":"Additional Scenarios > Sampling weights","what":"Using glm()","title":"Estimating the ADRF with *adrftools*","text":"survey design simple can captured using weights alone (.e., without stratification clustering), glm() weights argument can used instead svyglm(). special standard error required estimates valid, adrf() calculates standard error automatically vcov = \"unconditional\" (default). glm(), need set wts = TRUE call adrf() ensure weights properly included ADRF estimation. , weights used fitting outcome mode, ADRF generalize unweighted population. okay weights balancing weights, sampling weights, critical incorporated ADRF well.  Using wts = \"MEC_wts\" yield results can used weights used fit outcome model different used generalized ADRF (see combining sampling balancing weights).","code":"fit_gs <- glm(Math ~ splines::ns(logBLL, df = 5) *                (Age + Male + Race + PIR + Enough_Food + Smoke_in_Home +                   Smoke_Pregnant + NICU),              data = nhanes3lead,              weights = MEC_wt) adrf_gs <- adrf(fit_gs, treat = \"logBLL\",                 wts = TRUE)  plot(adrf_gs)"},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"sampling-weights-and-balancing-weights-together","dir":"Articles","previous_headings":"Additional Scenarios > Sampling weights","what":"Sampling weights and balancing weights together","title":"Estimating the ADRF with *adrftools*","text":"want use balancing weights sampling-weighted sample, additional considerations required. Importantly, product sampling weights balancing weights used fit outcome model, ADRF computed incorporating sampling weights alone. WeightIt straightforward; simply supplying s.weights argument weightit() makes everything work expected. automatically included outcome model fit glm_weightit()2. default, adrf() uses sampling weights, balancing weights, standardizing ADRF estimate. ensures estimates generalize sampling-weighted sample3.","code":"library(WeightIt)  w_sw_fit <- weightit(logBLL ~ Male + Age + Race + PIR + Enough_Food +                        Smoke_in_Home + Smoke_Pregnant + NICU,                      data = nhanes3lead,                      method = \"glm\",                      s.weights = \"MEC_wt\")  fit_sw <- glm_weightit(Math ~ splines::ns(logBLL, df = 5) *                          (Age + Male + Race + PIR + Enough_Food + Smoke_in_Home +                             Smoke_Pregnant + NICU),                        data = nhanes3lead,                        weightit = w_sw_fit) adrf_sw <- adrf(fit_sw, treat = \"logBLL\")  plot(adrf_sw)"},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"other-scenarios","dir":"Articles","previous_headings":"Additional Scenarios > Sampling weights","what":"Other scenarios","title":"Estimating the ADRF with *adrftools*","text":"general, wts can accept one arguments. Leaving NULL, two cases , automatically includes weights estimation ADRF outcome model fit using svyglm() using glm_weightit() s.weights supplied original call weightit(). Otherwise, weights included. use weights ADRF used fit outcome model, set wts = TRUE, glm() example . use set weights ADRF different used fit outcome model, supply names weights string numeric vector containing weights wts. done , example, product sampling weights balancing weights used fit outcome model sampling weights used computing ADRF (done without using glm_weightit(), automatically uses correct calculation).","code":""},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"multiply-imputed-data","dir":"Articles","previous_headings":"Additional Scenarios","what":"Multiply imputed data","title":"Estimating the ADRF with *adrftools*","text":"Multiple imputation popular strategy deal missing data, adrftools can accept models fit multiply imputed data compute ADRF. adrf() computes ADRF imputed dataset pools results, yielding single object similar one adrf() called single model. Rubin’s rules used pool ADRF estimates covariance matrix. adrftools requires <mira> objects mice (including <mimira> objects MatchThem); forms model fit imputed data need converted form, e.g., using mice::.mira(). , ’ll demonstrate using multiply imputed data generated mice adrftools. First, ’ll generate missing data artificially using mice::ampute(). Next, ’ll use mice::mice() impute missing data 5 imputed datasets. Note practice, many imputations used usual methods assessing convergence imputation quality implemented; skip . Next, can fit outcome model using () create <mira> object containing list model fits. can supply <mira> object adrf(), automatically estimates ADRF imputed dataset pools results.  option supported multiply imputed data bootstrapping. Setting vcov = \"boot\" vcov = \"fwb\" adrf() yield error.","code":"library(mice) set.seed(1234)  nhanes3lead_mis <- ampute(nhanes3lead, mech = \"MCAR\")$amp  summary(nhanes3lead_mis) #>       Age              Male              Race          PIR        #>  Min.   : 5.833   Min.   :0.0000   Black   :806   Min.   :0.000   #>  1st Qu.: 7.500   1st Qu.:0.0000   Hispanic:843   1st Qu.:0.671   #>  Median : 9.083   Median :1.0000   Other   :108   Median :1.287   #>  Mean   : 9.017   Mean   :0.5078   White   :684   Mean   :1.627   #>  3rd Qu.:10.500   3rd Qu.:1.0000   NA's    : 80   3rd Qu.:2.375   #>  Max.   :11.917   Max.   :1.0000                  Max.   :6.943   #>  NA's   :88       NA's   :89                      NA's   :79      #>   Enough_Food     Smoke_in_Home    Smoke_Pregnant        NICU        #>  Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   #>  1st Qu.:1.0000   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.0000   #>  Median :1.0000   Median :0.0000   Median :0.0000   Median :0.0000   #>  Mean   :0.8887   Mean   :0.3899   Mean   :0.1995   Mean   :0.1121   #>  3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:0.0000   3rd Qu.:0.0000   #>  Max.   :1.0000   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000   #>  NA's   :86       NA's   :77       NA's   :80       NA's   :85       #>      logBLL             Math           Reading           Block        #>  Min.   :-0.3567   Min.   : 0.000   Min.   : 0.000   Min.   : 1.000   #>  1st Qu.: 0.4700   1st Qu.: 6.000   1st Qu.: 4.000   1st Qu.: 7.000   #>  Median : 0.9933   Median : 8.000   Median : 7.000   Median : 9.000   #>  Mean   : 0.9730   Mean   : 7.947   Mean   : 6.977   Mean   : 8.666   #>  3rd Qu.: 1.4586   3rd Qu.:10.000   3rd Qu.:10.000   3rd Qu.:11.000   #>  Max.   : 3.3810   Max.   :20.000   Max.   :18.000   Max.   :19.000   #>  NA's   :86        NA's   :97       NA's   :90       NA's   :84       #>      Digit            MEC_wt          Block_bin      #>  Min.   : 1.000   Min.   :  213.4   Min.   :0.0000   #>  1st Qu.: 6.000   1st Qu.: 1660.2   1st Qu.:0.0000   #>  Median : 8.000   Median : 3117.1   Median :0.0000   #>  Mean   : 8.192   Mean   : 7190.2   Mean   :0.1861   #>  3rd Qu.:10.000   3rd Qu.: 9090.0   3rd Qu.:0.0000   #>  Max.   :19.000   Max.   :70105.7   Max.   :1.0000   #>  NA's   :78       NA's   :81        NA's   :76 imp <- mice(nhanes3lead_mis, m = 5, print = FALSE) fit_mi <- with(   imp,   lm(Math ~ splines::ns(logBLL, df = 5) *        (Age + Male + Race + PIR + Enough_Food + Smoke_in_Home +           Smoke_Pregnant + NICU)) ) adrf_mi <- adrf(fit_mi, treat = \"logBLL\")  plot(adrf_mi)"},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"using-matchthem","dir":"Articles","previous_headings":"Additional Scenarios > Multiply imputed data","what":"Using MatchThem","title":"Estimating the ADRF with *adrftools*","text":"estimate balancing weights multiply imputed data, can use MatchThem::weightthem(). analyses work similarly using mice alone.","code":"library(MatchThem)  w_mi <- weightthem(logBLL ~ Male + Age + Race + PIR + Enough_Food +                      Smoke_in_Home + Smoke_Pregnant + NICU,                    datasets = imp,                    method = \"glm\")  fit_w_mi <- with(   w_mi,   glm_weightit(Math ~ splines::ns(logBLL, df = 5) *                  (Age + Male + Race + PIR + Enough_Food + Smoke_in_Home +                     Smoke_Pregnant + NICU)) )  adrf_w_mi <- adrf(fit_w_mi, treat = \"logBLL\")  plot(adrf_w_mi)"},{"path":"https://ngreifer.github.io/adrftools/articles/adrftools.html","id":"bayesian-models","dir":"Articles","previous_headings":"Additional Scenarios","what":"Bayesian models","title":"Estimating the ADRF with *adrftools*","text":"described functionality works similarly Bayesian models (e.g., fit brms::brm(), dbarts::bart2(), rstanarm::stan_glm()) frequentist models. adrftools primarily frequentist ecosystem, special procedures exist Bayesian models well. fitting Bayesian outcome model, can supplied adrf() usual compute ADRF. Unlike frequentist models, ADRF posterior also computed forms basis inference ADRF. reported estimates expected posteriori (EAP) estimates. calling adrf() Bayesian model, vcov can set either \"none\" omit posterior just use EAP estimates \"posterior\" retain posterior inference. Leaving vcov unspecified uses \"posterior\". , fit Bayesian additive regression trees (BART) model using dbarts. credible intervals bands use confidence interval interface (e.g., using conf_level summary() plot() request credibility level). posterior can treated multivariate normal distribution compute Wald-based credible intervals setting ci.type = \"wald\", though default use equi-tailed percentile intervals ci.type = \"perc\". Simultaneous inference equi-tailed percentile intervals, requested, uses Bayesian algorithm described Montiel Olea Plagborg-Møller (2019), guarantees uniform credibility across whole effect curve. P-values estimates along effect curve computed complement smallest credibility level excludes null value.  Omnibus tests shape line (.e., using summary() <effect_curve> object) strictly frequentist use shifted version posterior sampling distribution effect curve null hypothesis. Bayesian models fit multiply imputed data, draws ADRF estimates across imputed datasets pooled form single posterior described Zhou Reiter (2010).","code":"library(dbarts)  bfit <- bart2(Math ~ logBLL + Male + Age + Race +                 PIR + Enough_Food + Smoke_in_Home +                  Smoke_Pregnant + NICU,             data = nhanes3lead,             keepTrees = TRUE, #needed for adrf()             verbose = FALSE)  adrf_bll_bayes <- adrf(bfit, treat = \"logBLL\")  adrf_bll_bayes #> An <effect_curve> object #>  #>  - curve type: ADRF #>  - response: Math #>  - treatment: logBLL #>    + range: -0.3567 to 2.4248 #>  - inference: posterior plot(adrf_bll_bayes) adrf_bll_bayes(logBLL = c(0, 1, 2)) |>   summary() #>         ADRF Estimates #> ─────────────────────────────── #>  logBLL Estimate CI Low CI High #>       0    8.434  8.063   9.160 #>       1    7.968  7.590   8.377 #>       2    7.180  6.613   7.837 #> ─────────────────────────────── #> Inference: posterior, simultaneous #> Confidence level: 95%"},{"path":[]},{"path":"https://ngreifer.github.io/adrftools/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Noah Greifer. Author, maintainer.","code":""},{"path":"https://ngreifer.github.io/adrftools/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Greifer N (2026). adrftools: Tools Estimating Average Dose-Response Functions. R package version 0.1.0, https://github.com/ngreifer/adrftools.","code":"@Manual{,   title = {adrftools: Tools for Estimating Average Dose-Response Functions},   author = {Noah Greifer},   year = {2026},   note = {R package version 0.1.0},   url = {https://github.com/ngreifer/adrftools}, }"},{"path":[]},{"path":[]},{"path":"https://ngreifer.github.io/adrftools/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Tools for Estimating Average Dose-Response Functions","text":"adrftools R package estimating average dose-response function (ADRF), characterizes effect continuous treatment outcome. Functionality included performing g-computation regression model estimate ADRF, plot ADRF, test hypotheses ADRF. See vignette(\"adrftools\") full tutorial using adrftools.","code":""},{"path":"https://ngreifer.github.io/adrftools/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Tools for Estimating Average Dose-Response Functions","text":"can install current stable version adrftools CRAN : can install development version adrftools GitHub :","code":"install.packages(\"adrftools\") # install.packages(\"pak\") pak::pak(\"ngreifer/adrftools\")"},{"path":"https://ngreifer.github.io/adrftools/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Tools for Estimating Average Dose-Response Functions","text":"use adrftools estimate characterize effect blood lead levels scores cognitive test, adjusting potential confounders using g-computation. , treatment logBLL, outcome Math, confounders adjusted Age, Male, Race, PIR, Enough_Food, Smoke_in_Home, Smoke_Pregnant, NICU. ’ll first fit outcome model adjusts confounders. Next ’ll use adrftools::adrf() compute ADRF. can plot ADRF using plot():  default, produces simultaneous 95% confidence bands. adrf_bll <effect_curve> object, function. can supply values treatment compute corresponding value ADRF treatment values: can also produce confidence intervals using summary() output: test omnibus hypothesis ADRF, whether flat linear, can use summary() <effect_curve> object : results indicate ADRF flat, isn’t enough evidence claim nonlinear range specified. might project linear model onto ADRF produce interpretable summary: , plot linear projection along original ADRF:  examine coefficient describing projection, can use summary() projection: Based , might conclude following: relationship logBLL Math adjusting included potential confounders, based rejection hypothesis ADRF flat logBLL values -0.3567 2.4248 (p < .0001). isn’t evidence ADRF nonlinear within range (p = .3153). linear projection coefficient -.643 (p < .0001), indicating expected potential outcome Math decreases amount unit increase logBLL. See vignette(\"adrftools\") information use adrftools features available.","code":"library(adrftools)  data(\"nhanes3lead\") fit <- lm(Math ~ splines::ns(logBLL, df = 5) *              (Age + Race + Male + PIR + Enough_Food +                Smoke_in_Home + Smoke_Pregnant + NICU),           data = nhanes3lead) adrf_bll <- adrf(fit, treat = \"logBLL\")  adrf_bll #> An <effect_curve> object #>  #>  - curve type: ADRF #>  - response: Math #>  - treatment: logBLL #>    + range: -0.3567 to 2.4248 #>  - inference: unconditional plot(adrf_bll) adrf_bll(logBLL = c(0, .5, 1, 1.5, 2)) #>  ADRF Estimates #> ──────────────── #>  logBLL Estimate #>     0.0    8.394 #>     0.5    8.305 #>     1.0    8.066 #>     1.5    7.484 #>     2.0    7.078 #> ──────────────── adrf_bll(logBLL = c(0, .5, 1, 1.5, 2)) |>   summary() #>               ADRF Estimates #> ────────────────────────────────────────── #>  logBLL Estimate Std. Error CI Low CI High #>     0.0    8.394     0.1706  7.959   8.829 #>     0.5    8.305     0.1247  7.987   8.624 #>     1.0    8.066     0.1129  7.778   8.354 #>     1.5    7.484     0.1436  7.117   7.850 #>     2.0    7.078     0.2186  6.520   7.635 #> ────────────────────────────────────────── #> Inference: unconditional, simultaneous #> Confidence level: 95% (t* = 2.55, df = 2455) # Test for flatness summary(adrf_bll, hypothesis = \"flat\") #>                   Omnibus Curve Test #> ─────────────────────────────────────────────────────── #> H₀: ADRF is flat for values of logBLL between -0.3567 #>     and 2.4248 #>  #>   P-value #>  < 0.0001 #> ─────────────────────────────────────────────────────── #> Computed using the Imhof approximation # Test for linearity summary(adrf_bll, hypothesis = \"linear\") #>                   Omnibus Curve Test #> ─────────────────────────────────────────────────────── #> H₀: ADRF is linear for values of logBLL between #>     -0.3567 and 2.4248 #>  #>  P-value #>   0.3153 #> ─────────────────────────────────────────────────────── #> Computed using the Imhof approximation proj <- curve_projection(adrf_bll, model = \"linear\") plot(adrf_bll, proj = proj) summary(proj) #>                  ADRF Projection Coefficients #> ────────────────────────────────────────────────────────────── #>         Term Estimate Std. Error     t  P-value CI Low CI High #>  (Intercept)    8.498     0.1329 63.95 < 0.0001  8.237   8.759 #>       logBLL   -0.643     0.1267 -5.07 < 0.0001 -0.891  -0.394 #> ────────────────────────────────────────────────────────────── #> Inference: unconditional #> Confidence level: 95% (t* = 1.961, df = 2455) #> Null value: 0"},{"path":"https://ngreifer.github.io/adrftools/reference/adrf.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate an average dose-response function (ADRF) — adrf","title":"Estimate an average dose-response function (ADRF) — adrf","text":"Estimates average dose-response function (ADRF) fitted model object.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/adrf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate an average dose-response function (ADRF) — adrf","text":"","code":"adrf(x, ...)  # Default S3 method adrf(   x,   treat,   vcov = \"unconditional\",   cluster = NULL,   type = \"response\",   data = NULL,   subset = NULL,   by = NULL,   wts = NULL,   range = 0.95,   n = 71,   fwb.args = list(),   ... )"},{"path":"https://ngreifer.github.io/adrftools/reference/adrf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate an average dose-response function (ADRF) — adrf","text":"x fitted model object (e.g., lm() glm()). ... arguments passed marginaleffects::get_predict(). treat string specifying name treatment variable. vcov covariance matrix estimates computed. \"unconditional\" (default frequentist models), use sandwich estimator including sampling uncertainty. \"boot\" \"fwb\", use traditional fractional weighted bootstrap, respectively (require fwb package installed). Otherwise, may covariance matrix allowed input vcov argument marginaleffects::get_vcov(). Can also \"none\" avoid computing uncertainty. Bayesian models, \"posterior\", uses posterior estimates, \"none\" allowed. models fit multiply imputed data, \"boot\" \"fwb\" allowed. cluster optional data frame one-sided formula clustering terms cluster-robust inference. type character string indicating type prediction. Passed marginaleffects::get_predict(). Default \"response\" predictions scale outcome variable. options might include \"link\" linear predictor. argument ignored lm objects. data optional data frame containing observations originally used fit outcome model supplied x. used supplied model supported insight. cases, need supplied. subset optional logical expression indicating subset data use estimation. evaluated environment original dataset supplied model fitting function. optional variable(s) group estimation. Can character vector one-sided formula. wts optional numeric vector weights generalize effect curve weighted population. range numeric; numeric vector corresponding either lower upper bounds treatment values compute affect curve single number corresponding middle quantile treatment. Default .95 use .025 .975 quantiles treatment. See Details. n integer specifying number equally spaced grid points compute effect curve anchor points. Default 70; higher numbers increase computation time size resulting object improve accuracy. fwb.args option list arguments passed fwb::fwb()  vcov \"boot\" \"fwb\".","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/adrf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate an average dose-response function (ADRF) — adrf","text":"object class effect_curve. object function attributes. See effect_curve details function outputs.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/adrf.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate an average dose-response function (ADRF) — adrf","text":"adrf() estimates ADRF computing average predicted outcomes sample counterfactual treatment values, optionally stratified grouping variables accounting estimation uncertainty via unconditional conditional variance estimation bootstrapping. Unconditional variance estimation bootstrapping treat sample random. vcov = \"unconditional\", variance computed using formulas Hansen et al. (2024), involves augmenting influence function term account sampling superpopulation. Unconditional variance estimation requires sandwich::estfun() sandwich::bread() methods supplied object available. mira object mice mimira object MatchThem supplied, analyses applied imputed dataset pooled using Rubin's rules. Bootstrapping allowed objects. svyglm object survey supplied, adrf() automatically incorporates survey weights extracted object. true glm_weightit objects, etc., WeightIt s.weights supplied original call weightit(). See vignette(\"adrftools\") details using wts argument.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/adrf.html","id":"range","dir":"Reference","previous_headings":"","what":"range","title":"Estimate an average dose-response function (ADRF) — adrf","text":"range argument controls range treatment effect curve evaluated. can supplied either two numbers corresponding lower upper bounds treatment (e.g., range = c(0, 10)) single number corresponding middle quantile treatment (e.g., range = .9, uses .05 .95 quantiles treatment bounds). default .95 use .025 .975 quantiles treatment. supplied quantile, quantiles evaluated incorporating weights supplied wts. reason use full treatment range (e.g., setting range = 1) likely little certainty effect curve treatment extremes. uncertainty can muddy tests effect curve. However, limiting treatment range means inferences effect curve less generalizable extreme values treatment. Note change data used fit effect curve, just points along effect curve inference estimation take place.","code":""},{"path":[]},{"path":"https://ngreifer.github.io/adrftools/reference/adrf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate an average dose-response function (ADRF) — adrf","text":"","code":"data(\"nhanes3lead\")  fit <- lm(Math ~ poly(logBLL, 5) *             Male * (Age + Race + PIR +                       Enough_Food),           data = nhanes3lead)  # ADRF of logBLL on Math, unconditional # inference adrf1 <- adrf(fit, treat = \"logBLL\")  adrf1 #> An <effect_curve> object #>  #>  - curve type: ADRF #>  - response: Math #>  - treatment: logBLL #>    + range: -0.3567 to 2.4248 #>  - inference: unconditional #>   ## Plot the ADRF plot(adrf1)   ## ADRF estimates at given points adrf1(logBLL = c(0, 1, 2)) |>   summary() #>               ADRF Estimates #> ────────────────────────────────────────── #>  logBLL Estimate Std. Error CI Low CI High #>       0    8.413     0.2206  7.887   8.939 #>       1    8.005     0.0993  7.768   8.241 #>       2    7.103     0.2390  6.533   7.673 #> ────────────────────────────────────────── #> Inference: unconditional, simultaneous #> Confidence level: 95% (t* = 2.385, df = 2437)  # ADRF of logBLL on Math, unconditional # inference; manual range adrf2 <- adrf(fit, treat = \"logBLL\",               range = c(0, 2))  adrf2 #> An <effect_curve> object #>  #>  - curve type: ADRF #>  - response: Math #>  - treatment: logBLL #>    + range: 0 to 2 #>  - inference: unconditional #>   plot(adrf2)   # ADRF of logBLL on Math, bootstrap # inference if (FALSE) { # \\dontrun{ adrf_b <- adrf(fit, treat = \"logBLL\",                vcov = \"fwb\")  adrf_b  plot(adrf_b) } # }  # ADRF in subset adrf_m <- adrf(fit, treat = \"logBLL\",                subset = Male == 1)  adrf_m #> An <effect_curve> object #>  #>  - curve type: ADRF #>  - response: Math #>  - treatment: logBLL #>    + range: -0.3567 to 2.4248 #>  - inference: unconditional #>   # ADRFs in subgroups adrf_by <- adrf(fit, treat = \"logBLL\",                 by = ~Male)  adrf_by #> An <effect_curve> object #>  #>  - curve type: ADRF #>  - response: Math #>  - treatment: logBLL #>    + range: -0.3567 to 2.4248 #>  - by: Male #>  - inference: unconditional #>"},{"path":"https://ngreifer.github.io/adrftools/reference/adrftools-package.html","id":null,"dir":"Reference","previous_headings":"","what":"adrftools: Tools for Estimating Average Dose-Response Functions — adrftools-package","title":"adrftools: Tools for Estimating Average Dose-Response Functions — adrftools-package","text":"Provides tools estimating, visualizing, testing average dose-response functions characterizing causal effect continuous (.e., non-discrete) treatment exposure.","code":""},{"path":[]},{"path":"https://ngreifer.github.io/adrftools/reference/adrftools-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"adrftools: Tools for Estimating Average Dose-Response Functions — adrftools-package","text":"Maintainer: Noah Greifer noah.greifer@gmail.com (ORCID)","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/amef.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate the average marginal effect function (AMEF) — amef","title":"Estimate the average marginal effect function (AMEF) — amef","text":"amef() computes average marginal effect function (AMEF), derivative average dose-response function (ADRF). computed adrf_curve object fitting outcome model directly.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/amef.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate the average marginal effect function (AMEF) — amef","text":"","code":"amef(x, eps = 1e-05)"},{"path":"https://ngreifer.github.io/adrftools/reference/amef.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate the average marginal effect function (AMEF) — amef","text":"x adrf_curve object; output call adrf(). eps numeric; step size use calculating numerical derivatives. Default 1e-5 (.00001). See Details.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/amef.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate the average marginal effect function (AMEF) — amef","text":"object class amef_curve, inherits effect_curve.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/amef.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate the average marginal effect function (AMEF) — amef","text":"AMEF calculated numerically using central finite derivative formula: $$\\frac{df(x)}\\frac{dx} \\approx \\frac{f(x + e) - f(x - e)}{2e}$$ values ADRF evaluation points computed using local polynomial regression described effect_curve. boundaries ADRF, one-sided derivatives used.","code":""},{"path":[]},{"path":"https://ngreifer.github.io/adrftools/reference/amef.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate the average marginal effect function (AMEF) — amef","text":"","code":"data(\"nhanes3lead\")  fit <- lm(Math ~ poly(logBLL, 5) *             Male * (Age + Race + PIR +                       Enough_Food),           data = nhanes3lead)  # ADRF of logBLL on Math adrf1 <- adrf(fit, treat = \"logBLL\")  # AMEF of logBLL on Math amef1 <- amef(adrf1)  amef1 #> An <effect_curve> object #>  #>  - curve type: AMEF #>  - response: Math #>  - treatment: logBLL #>    + range: -0.3567 to 2.4248 #>  - inference: unconditional #>   # Plot the AMEF plot(amef1)   # AMEF estimates at given points amef1(logBLL = c(0, 1, 2)) |>   summary() #>                       AMEF Estimates #> ─────────────────────────────────────────────────────────── #>  logBLL Estimate Std. Error       t P-value  CI Low CI High #>       0  -0.1768     0.4285 -0.4125  0.9549 -1.1854  0.8318 #>       1  -0.8144     0.2780 -2.9296  0.0097 -1.4687 -0.1601 #>       2  -0.7111     0.7004 -1.0152  0.6160 -2.3597  0.9374 #> ─────────────────────────────────────────────────────────── #> Inference: unconditional, simultaneous #> Confidence level: 95% (t* = 2.354, df = 2437) #> Null value: 0"},{"path":"https://ngreifer.github.io/adrftools/reference/curve_contrast.html","id":null,"dir":"Reference","previous_headings":"","what":"Contrast multiple subgroup effect curves — curve_contrast","title":"Contrast multiple subgroup effect curves — curve_contrast","text":"curve_contrast() computes difference effect curves across levels subgrouping variable supplied original call adrf().","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/curve_contrast.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Contrast multiple subgroup effect curves — curve_contrast","text":"","code":"curve_contrast(x)"},{"path":"https://ngreifer.github.io/adrftools/reference/curve_contrast.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Contrast multiple subgroup effect curves — curve_contrast","text":"x effect_curve object; output call adrf() supplied.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/curve_contrast.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Contrast multiple subgroup effect curves — curve_contrast","text":"object class contrast_curve, inherits effect_curve, additional information groups contrasted.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/curve_contrast.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Contrast multiple subgroup effect curves — curve_contrast","text":"curve_contrast() creates new effect curve corresponding difference effect curves two groups. multiple subgroups specified original call adrf(), pairwise comparisons included. Use subset argument original function call restrict comparisons fewer groups.","code":""},{"path":[]},{"path":"https://ngreifer.github.io/adrftools/reference/curve_contrast.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Contrast multiple subgroup effect curves — curve_contrast","text":"","code":"data(\"nhanes3lead\")  fit <- lm(Math ~ poly(logBLL, 5) *             Male * Smoke_in_Home *             (Age + Race + PIR),           data = nhanes3lead)  # ADRFs in Race subgroups, excluding Other adrf_by <- adrf(fit, treat = \"logBLL\",                 by = ~Race,                 subset = Race != \"Other\")  adrf_by #> An <effect_curve> object #>  #>  - curve type: ADRF #>  - response: Math #>  - treatment: logBLL #>    + range: -0.3567 to 2.4248 #>  - by: Race #>  - inference: unconditional #>   # Contrast subgroup ADRFs adrf_contrast <- curve_contrast(adrf_by)  adrf_contrast #> An <effect_curve> object #>  #>  - curve type: ADRF contrast #>  - response: Math #>  - treatment: logBLL #>    + range: -0.3567 to 2.4248 #>  - contrasts: [Race = \"Hispanic\"] - [Race = \"Black\"], [Race = \"White\"] - [Race = \"Black\"], [Race = \"White\"] - [Race = \"Hispanic\"] #>  - inference: unconditional #>   # Plot contrast ADRFs plot(adrf_contrast, simultaneous = FALSE)   # Compute and test difference between subgroup # ADRFs at specific points adrf_contrast(logBLL = c(0, 2)) |>   summary() #>                          ADRF Contrast Estimates #> ───────────────────────────────────────────────────────────────────────── #>                                Contrast logBLL Estimate Std. Error      t #>  [Race = \"Hispanic\"] - [Race = \"Black\"]      0  -0.3925     0.4885 -0.804 #>  [Race = \"Hispanic\"] - [Race = \"Black\"]      2   0.2837     0.3625  0.783 #>     [Race = \"White\"] - [Race = \"Black\"]      0   1.7703     0.5265  3.362 #>     [Race = \"White\"] - [Race = \"Black\"]      2  -0.3083     0.6162 -0.500 #>  [Race = \"White\"] - [Race = \"Hispanic\"]      0   2.1628     0.5120  4.225 #>  [Race = \"White\"] - [Race = \"Hispanic\"]      2  -0.5920     0.6297 -0.940 #> ───────────────────────────────────────────────────────────────────────── #> Inference: unconditional, simultaneous #> Confidence level: 95% (t* = 2.59, df = 2377) #> Null value: 0  # Test if ADRF differences are present summary(adrf_contrast) #>                   Omnibus Curve Test #> ─────────────────────────────────────────────────────── #> H₀: ADRF contrast is 0 for values of logBLL between #>     -0.3567 and 2.4248 #>  #>                                Contrast P-value #>  [Race = \"Hispanic\"] - [Race = \"Black\"]  0.8651 #>     [Race = \"White\"] - [Race = \"Black\"]  0.0006 #>  [Race = \"White\"] - [Race = \"Hispanic\"]  0.0002 #> ─────────────────────────────────────────────────────── #> Computed using the Imhof approximation"},{"path":"https://ngreifer.github.io/adrftools/reference/curve_projection.html","id":null,"dir":"Reference","previous_headings":"","what":"Project an effect curve onto a simpler model — curve_projection","title":"Project an effect curve onto a simpler model — curve_projection","text":"curve_projection() produces projection estimated effect curve onto specified linear model function treatment act interpretable summary original effect curve.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/curve_projection.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Project an effect curve onto a simpler model — curve_projection","text":"","code":"curve_projection(x, model, transform = TRUE)  # S3 method for class 'curve_projection' summary(   object,   conf_level = 0.95,   null = 0,   df = NULL,   ci.type = \"perc\",   subset = NULL,   ... )  # S3 method for class 'curve_projection' coef(object, ...)  # S3 method for class 'curve_projection' vcov(object, ...)  # S3 method for class 'curve_projection' anova(object, object2, df = NULL, ...)"},{"path":"https://ngreifer.github.io/adrftools/reference/curve_projection.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Project an effect curve onto a simpler model — curve_projection","text":"x effect_curve object; output call adrf(). model projection model fit. Can one-sided formula corresponding projection model one following strings: \"flat\", \"linear\", \"quadratic\", \"cubic\". transform whether compute projection using transformation linear predictor. Allowable options include TRUE, FALSE, function specifying transformation (inverse used inverse link projection model). Ignored unless object ADRF. See Details. object, object2 curve_projection object; output call curve_projection(). conf_level desired confidence level. Set 0 omit confidence intervals. Default .95. null null value hypothesis test. Default 0. Set NA omit tests. df \"denominator\" degrees freedom use test. Default use residual degrees freedom original model linear model (case F-test used) Inf otherwise (case \\(\\chi^2\\) test used). ci.type string; bootstrapping Bayesian inference used original effect curve, type confidence interval computed. bootstrapping, allowable options include \"perc\" percentile intervals, \"wald\" Wald intervals, options allowed fwb::summary.fwb() . simultaneous = TRUE, \"perc\" \"wald\" allowed. Bayesian models, allowable options include \"perc\" equi-tailed intervals \"wald\" Wald intervals. Default \"perc\". Ignored bootstrapping used model Bayesian. subset optional logical expression indicating subset subgroups compute projection. Can used supplied original call adrf(), refer variables defining subgroups. ... ignored.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/curve_projection.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Project an effect curve onto a simpler model — curve_projection","text":"curve_projection() returns curve_projection object, inherits effect_curve. object function produces estimates effect curve projection called values treatment inputs. See effect_curve details calling function. coefficients covariance matrix fitted projection extracted coef() vcov(), respectively. summary() produces coefficients quantities interest inference (test statistics, p-values, confidence intervals). Using plot() curve_projection object plots projection curve effect curve; see plot.effect_curve() adding projection curve plot original effect curve.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/curve_projection.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Project an effect curve onto a simpler model — curve_projection","text":"projection model can thought linear regression effect curve estimates treatment. Whereas original effect curve may complicated nonlinear, projection model can simple easily interpretable, though must understood summary original effect curve. example, original ADRF might computed outcome model involves treatment splines, covariates, treatment-covariate interactions. Though ADRF univariable function (.e., treatment), described single set parameters. linear projection ADRF, though, simple linear model, described intercept slope treatment. Though rough approximation ADRF, linear projection may easily interpreted. concept described Neugebauer van der Laan (2007). curve_projection() fits projection model accounts uncertainty estimates effect curve computing uncertainty estimates projection model parameters. true effect curve continuous, model fit minimizing $$\\int_{a_\\text{lower}}^{a_\\text{upper}}{\\left(\\hat{\\theta}()-\\hat{\\mathbf{\\beta}} B() \\right)^2 da}$$ \\(\\hat{\\theta}()\\) effect curve estimate treatment value \\(\\), \\(B()\\) basis function representation \\(\\) (.e., specified model), \\(\\hat{\\mathbf{\\beta}}\\) vector projection parameters estimated. integral approximated using trapezoidal Riemann sum effect curve grid points. covariance projection parameters can computed using delta method applied estimated covariance original effect curve estimates. bootstrapping posterior inference used, projection applied bootstrap posterior draw, respectively.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/curve_projection.html","id":"transform","dir":"Reference","previous_headings":"","what":"Transform","title":"Project an effect curve onto a simpler model — curve_projection","text":"transform specified, projection minimizes distance original effect curve transformed linear predictor; , minimizes $$\\int_{a_\\text{lower}}^{a_\\text{upper}}{\\left(\\hat{\\theta}()-f^{-1}\\left(\\hat{\\mathbf{\\beta}} B() \\right) \\right)^2 da}$$ \\(f^{-1}(y)\\) inverse transformation supplied transform (.e., corresponding inverse link function generalized linear model), essentially using nonlinear least squares (NLS) estimate effect curve projection. make coefficients projection model correspond coefficients linear predictor \\(\\hat{\\mathbf{\\beta}} B()\\). case, projection simply linear projection, may still interpretable original ADRF. example, outcome model originally fit using logistic regression transform = TRUE call curve_projection() model = \"linear\", resulting projection logistic curve governed intercept slope linear predictor. See Examples example . default, transform TRUE, means original outcome model family component (e.g., generalized linear model) ADRF supplied curve_projection(), link automatically supplied transform projection model nonlinear function linear predictor. Set transform FALSE require projection curve simply linear predictor transformation. Note can lead invalid estimates outcome bounded.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/curve_projection.html","id":"comparing-projection-models","dir":"Reference","previous_headings":"","what":"Comparing projection models","title":"Project an effect curve onto a simpler model — curve_projection","text":"anova() performs Wald test comparing two nested projection models. null hypothesis simpler model sufficient, .e., coefficients terms larger model (supplied object) smaller model (supplied object2) zero. Rejecting null hypothesis implies larger model fits better.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/curve_projection.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Project an effect curve onto a simpler model — curve_projection","text":"Neugebauer, R., & van der Laan, M. (2007). Nonparametric causal effects based marginal structural models. Journal Statistical Planning Inference, 137(2), 419–434. doi:/10.1016/j.jspi.2005.12.008","code":""},{"path":[]},{"path":"https://ngreifer.github.io/adrftools/reference/curve_projection.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Project an effect curve onto a simpler model — curve_projection","text":"","code":"data(\"nhanes3lead\")  fit <- lm(Math ~ poly(logBLL, 5) *             (Male + Age + Race + PIR +                Enough_Food),           data = nhanes3lead)  # ADRF of logBLL on Math, unconditional # inference adrf1 <- adrf(fit, treat = \"logBLL\")  # Linear projection is sufficient for # characterizing the ADRF summary(adrf1, hypothesis = \"linear\") #>                   Omnibus Curve Test #> ─────────────────────────────────────────────────────── #> H₀: ADRF is linear for values of logBLL between #>     -0.3567 and 2.4248 #>  #>  P-value #>    0.375 #> ─────────────────────────────────────────────────────── #> Computed using the Imhof approximation  # Compute the linear projection proj1 <- curve_projection(adrf1, \"linear\") # proj1 <- curve_projection(adrf1, ~logBLL) #same model  proj1 #> An <effect_curve> object #>  #>  - curve type: ADRF projection #>  - response: Math #>  - treatment: logBLL #>    + range: -0.3567 to 2.4248 #>  - projection model: ~logBLL #>  - inference: unconditional #>   # Coefficients of the projection model coef(proj1) #> (Intercept)      logBLL  #>   8.5703241  -0.7198424  summary(proj1) #>                  ADRF Projection Coefficients #> ────────────────────────────────────────────────────────────── #>         Term Estimate Std. Error     t  P-value CI Low CI High #>  (Intercept)     8.57     0.1494 57.37 < 0.0001  8.277   8.863 #>       logBLL    -0.72     0.1424 -5.06 < 0.0001 -0.999  -0.441 #> ────────────────────────────────────────────────────────────── #> Inference: unconditional #> Confidence level: 95% (t* = 1.961, df = 2473) #> Null value: 0  # Plot the projection plot(proj1)   # Plot the projection over the ADRF plot(adrf1, proj = proj1)   # Compute a cubic projection proj2 <- curve_projection(adrf1, \"cubic\") # proj2 <- curve_projection(adrf1, ~poly(logBLL, 3)) #same model  # Compare cubic to linear projection anova(proj2, proj1) #>                        Wald Test #> ─────────────────────────────────────────────────────── #> Model 1: ~logBLL + I(logBLL^2) + I(logBLL^3) #> Model 2: ~logBLL #>  #> H₀: Extra terms in Model 1 have coefficients equal to #>     0 (i.e., Model 2 is sufficient) #>  #>  df      F P-value #>   2 1.3587  0.2572 #> ─────────────────────────────────────────────────────── #> Inference: unconditional (df = 2473)"},{"path":"https://ngreifer.github.io/adrftools/reference/effect_curve.html","id":null,"dir":"Reference","previous_headings":"","what":"Effect curve objects — effect_curve","title":"Effect curve objects — effect_curve","text":"effect_curve object function takes values treatment produces estimates effect curve values. effect_curve objects produces adrf() functions modify effect curves, amef(), curve_contrast(), reference_curve(), curve_projection(). output effect_curve object curve_est object containing effect curve estimates. page describes effect_curve curve_est objects.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/effect_curve.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Effect curve objects — effect_curve","text":"","code":"f <- adrf(x, ...)  f({treat}, subset = NULL)"},{"path":"https://ngreifer.github.io/adrftools/reference/effect_curve.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Effect curve objects — effect_curve","text":"{treat} values treatment evaluate effect curve. subset optional logical expression indicating subset subgroups compute estimates. Can used supplied original call adrf(), refer variables defining subgroups. x curve_est object; output effect_curve object call. digits number digits display. ... arguments passed print.data.frame().","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/effect_curve.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Effect curve objects — effect_curve","text":"call effect_curve object returns curve_est object, data.frame containing column treatment column effect curve estimates. curve_est objects print(), summary(), ceof(), vcov() methods.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/effect_curve.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Effect curve objects — effect_curve","text":"effect_curve object contains set grid points effect curve initially evaluated. effect curve estimates produced call effect_curve object interpolated using 3rd-degree local polynomial regression Gaussian kernel bandwidth equal half distance grid points, unless coincide grid points; means produced estimates linear combinations grid point estimates.","code":""},{"path":[]},{"path":"https://ngreifer.github.io/adrftools/reference/effect_curve.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Effect curve objects — effect_curve","text":"","code":"data(\"nhanes3lead\")  fit <- lm(Math ~ poly(logBLL, 5) *             (Male + Age + Race + PIR +                Enough_Food),           data = nhanes3lead)  # ADRF of logBLL on Math, unconditional # inference adrf1 <- adrf(fit, treat = \"logBLL\")  adrf1 #> An <effect_curve> object #>  #>  - curve type: ADRF #>  - response: Math #>  - treatment: logBLL #>    + range: -0.3567 to 2.4248 #>  - inference: unconditional #>   # Compute estimates along the ADRF adrf1(logBLL = c(0, 1, 2)) #>  ADRF Estimates #> ──────────────── #>  logBLL Estimate #>       0    8.470 #>       1    8.012 #>       2    7.029 #> ────────────────  # Perform inference on the estimates adrf1(logBLL = c(0, 1, 2)) |>   summary() #>               ADRF Estimates #> ────────────────────────────────────────── #>  logBLL Estimate Std. Error CI Low CI High #>       0    8.470     0.2196  7.946   8.993 #>       1    8.012     0.0985  7.777   8.247 #>       2    7.029     0.2298  6.482   7.577 #> ────────────────────────────────────────── #> Inference: unconditional, simultaneous #> Confidence level: 95% (t* = 2.384, df = 2473)  # ADRF within groups defined by `Male` adrf2 <- adrf(fit, treat = \"logBLL\",               by = ~Male)  adrf2 #> An <effect_curve> object #>  #>  - curve type: ADRF #>  - response: Math #>  - treatment: logBLL #>    + range: -0.3567 to 2.4248 #>  - by: Male #>  - inference: unconditional #>   # Estimates in both groups adrf2(logBLL = c(0, 1, 2)) #>    ADRF Estimates #> ───────────────────── #>  Male logBLL Estimate #>     0      0    8.367 #>     0      1    8.406 #>     0      2    7.281 #>     1      0    8.569 #>     1      1    7.631 #>     1      2    6.786 #> ─────────────────────  # Estimates in one group adrf2(logBLL = c(0, 1, 2), subset = Male == 1) #>    ADRF Estimates #> ───────────────────── #>  Male logBLL Estimate #>     1      0    8.569 #>     1      1    7.631 #>     1      2    6.786 #> ─────────────────────"},{"path":"https://ngreifer.github.io/adrftools/reference/nhanes3lead.html","id":null,"dir":"Reference","previous_headings":"","what":"Data from NHANES III on blood lead levels and cognitive outcomes — nhanes3lead","title":"Data from NHANES III on blood lead levels and cognitive outcomes — nhanes3lead","text":"subsample data NHANES III containing observations 2521 adolescents participated survey, particular portions survey included assessing participants' blood lead levels  scores several cognitive tests.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/nhanes3lead.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Data from NHANES III on blood lead levels and cognitive outcomes — nhanes3lead","text":"","code":"nhanes3lead"},{"path":"https://ngreifer.github.io/adrftools/reference/nhanes3lead.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Data from NHANES III on blood lead levels and cognitive outcomes — nhanes3lead","text":"object class data.frame 2521 rows 14 columns.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/nhanes3lead.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Data from NHANES III on blood lead levels and cognitive outcomes — nhanes3lead","text":"treatment logBLL, natural log blood levels measured μg/dL. covariates Age, Male, Race, PIR, Enough_Food, Smoke_in_Home, Smoke_Pregnant, NICU. outcomes Math, Reading, Block, Digit. MEC_wt sampling weights.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/plot.effect_curve.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot an effect curve — plot.effect_curve","title":"Plot an effect curve — plot.effect_curve","text":"plot() plots effect curve confidence band.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/plot.effect_curve.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot an effect curve — plot.effect_curve","text":"","code":"# S3 method for class 'effect_curve' plot(   x,   conf_level = 0.95,   simultaneous = TRUE,   null = NULL,   subset = NULL,   proj = NULL,   transform = TRUE,   ci.type = \"perc\",   df = NULL,   ... )"},{"path":"https://ngreifer.github.io/adrftools/reference/plot.effect_curve.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot an effect curve — plot.effect_curve","text":"x effect_curve object; output call adrf() functions modify . conf_level desired confidence level. Default .95 95% confidence bands. simultaneous logical; whether computed confidence bands simultaneous (TRUE) pointwise (FALSE). Simultaneous (also known uniform) bands cover full line desired confidence level, whereas pointwise confidence bands cover point desired level. Default TRUE. See Details. null value plot horizontal reference line. Default plot line y-intercept 0 effect curve AMEF, curve contrast, reference effect curve, omit line otherwise. Set NA manually omit line. subset optional logical expression indicating subset subgroups plot. Can used supplied original call adrf(), refer variables defining subgroups. proj optional curve_projection object, output call curve_projection(). Supplying adds projection curve effect curve plot. transform whether compute intervals transformed estimates. Allowable options include TRUE, FALSE, function specifying transformation. Ignored unless x ADRF. See Details. ci.type string; bootstrapping used original effect curve, type confidence interval computed. Allowable options include \"perc\" percentile intervals, \"wald\" Wald intervals, options allowed fwb::summary.fwb() . simultaneous = TRUE, \"perc\" \"wald\" allowed. Default \"perc\". Ignored bootstrapping used. df \"denominator\" degrees freedom use critical test statistics confidence bands. Default use residual degrees freedom original model linear model Inf otherwise. ... ignored.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/plot.effect_curve.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot an effect curve — plot.effect_curve","text":"ggplot object can modified using functions ggplot2. common tasks instructions perform . Note run running library(\"ggplot2\"). Change position legend: Remove legend: Change color plotted line: Change color scheme plotted lines: Change title, subtitle, axis labels: Change y-axis range: Strings brackets changed user. Refer ggplot2 documentation options.","code":"theme(legend.position = \"{POSITION}\") theme(legend.position = \"none\") theme(geom = element_geom(ink = \"{COLOR}\") scale_color_brewer(aesthetics = c(\"color\", \"fill\"),                    palette = \"{PALETTE}\") labs(title = \"{TITLE}\", subtitle = \"{SUBTITLE}\",      x = \"{X-AXIS}\", y = \"{Y-AXIS}\") coord_cartesian(ylim = c({LOWER}, {UPPER}),                 expand = FALSE)"},{"path":"https://ngreifer.github.io/adrftools/reference/plot.effect_curve.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot an effect curve — plot.effect_curve","text":"plot() displays effect curve plot. solid line corresponds effect curve ribbon around corresponds confidence band. null NA, additional flat line null displayed. proj supplied, dashed line corresponding projection added. supplied adrf(), plot() produces effect curve plot subgroup. x output call curve_contrast(), plot() produces effect curve plot treatment contrast.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/plot.effect_curve.html","id":"transform","dir":"Reference","previous_headings":"","what":"Transform","title":"Plot an effect curve — plot.effect_curve","text":"usual confidence bands assume estimates along effect curve normally distributed (t-distributed df Inf). However, outcome bounded (e.g., probability bounded 0 1), assumption may valid ADRF finite samples. transform transforms estimates ones unbounded computes corresponding distribution transformed estimates using delta method. default, generalized linear model used outcome non-identity link function, estimates transformed link function unbounded scale. Note using linear predictor effect curve; simple transformation estimated points along curve already computed. Confidence bands computed using transformed estimates back-transformed ensure within bounds outcome.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/plot.effect_curve.html","id":"simultaneous-confidence-bands","dir":"Reference","previous_headings":"","what":"Simultaneous confidence bands","title":"Plot an effect curve — plot.effect_curve","text":"Simultaneous confidence bands ensure whole effect curve, just given individual point, contained within band given confidence level. wider pointwise bands reflect covering multiple estimates, otherwise decrease true coverage rate specified. plot() uses \"sup-t\" simultaneous confidence band, smallest one-parameter band covers whole effect curve desired rate.","code":""},{"path":[]},{"path":"https://ngreifer.github.io/adrftools/reference/plot.effect_curve.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot an effect curve — plot.effect_curve","text":"","code":"data(\"nhanes3lead\")  fit <- glm(Block >= 12 ~ poly(logBLL, 3) *              Male * (Age + Race + PIR + NICU +                        Smoke_Pregnant),            data = nhanes3lead,            family = binomial)  # ADRF of logBLL on P(Block >= 12) adrf1 <- adrf(fit, treat = \"logBLL\",               n = 50) #using 50 to speed up examples  # Plot the ADRF; simultaneous inference, # CIs computed on transformed estimates plot(adrf1)   # Plot the ADRF; simultaneous inference, # CIs computed on original estimates plot(adrf1, transform = FALSE)   # Plot the ADRF; pointwise inference plot(adrf1, simultaneous = FALSE)   # ADRF within subgroups adrf2 <- adrf(fit, treat = \"logBLL\",               by = ~Male, n = 50)  # Plot subgroup ADRFs plot(adrf2)   # Plot ADRF in one subgroup plot(adrf2, subset = Male == 1)   # ADRF contrast adrf_contrast <- curve_contrast(adrf2)  plot(adrf_contrast)"},{"path":"https://ngreifer.github.io/adrftools/reference/point_contrast.html","id":null,"dir":"Reference","previous_headings":"","what":"Contrast point estimates along an effect curve — point_contrast","title":"Contrast point estimates along an effect curve — point_contrast","text":"point_contrast() computes pairwise contrasts estimates effect curve.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/point_contrast.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Contrast point estimates along an effect curve — point_contrast","text":"","code":"point_contrast(object)  # S3 method for class 'curve_est_contrast' summary(   object,   conf_level = 0.95,   simultaneous = TRUE,   null = 0,   ci.type = \"perc\",   df = NULL,   ... )"},{"path":"https://ngreifer.github.io/adrftools/reference/point_contrast.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Contrast point estimates along an effect curve — point_contrast","text":"object point_contrast(), curve_est object; output effect_curve object. summary(), curve_est_contrast object; output call point_contrast(). conf_level desired confidence level. Set 0 omit confidence intervals. Default .95. simultaneous logical; whether computed p-values confidence intervals simultaneous (TRUE) pointwise (FALSE). Simultaneous (also known uniform) intervals jointly cover specified estimates desired confidence level, whereas pointwise confidence intervals cover estimate desired level. Simultaneous p-values inversions simultaneous confidence intervals. Default TRUE. See Details. null null value hypothesis tests. Default 0. Set NA omit tests. ci.type string; bootstrapping Bayesian inference used original effect curve, type confidence interval computed. bootstrapping, allowable options include \"perc\" percentile intervals, \"wald\" Wald intervals, options allowed fwb::summary.fwb() . simultaneous = TRUE, \"perc\" \"wald\" allowed. Bayesian models, allowable options include \"perc\" equi-tailed intervals \"wald\" Wald intervals. Default \"perc\". Ignored bootstrapping used model Bayesian. df \"denominator\" degrees freedom use tests critical test statistics confidence intervals. Default use residual degrees freedom original model linear model Inf otherwise. ... ignored.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/point_contrast.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Contrast point estimates along an effect curve — point_contrast","text":"point_contrast() returns object class curve_est_contrast, like curve_est object summary() method.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/point_contrast.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Contrast point estimates along an effect curve — point_contrast","text":"point_contrast() computes pairwise contrasts effect curve estimates. pairwise contrasts linear operation original estimates, delta method can used perform Wald inference contrasts. specified original call adrf() effect curve contrast_curve object resulting curve_contrast(), pairwise contrasts occur within subgroups within subgroup contrasts, respectively. compare points effect curve single point, use reference_curve().","code":""},{"path":[]},{"path":"https://ngreifer.github.io/adrftools/reference/point_contrast.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Contrast point estimates along an effect curve — point_contrast","text":"","code":"data(\"nhanes3lead\")  fit <- lm(Math ~ poly(logBLL, 5) *             (Male + Age + Race + PIR +                Enough_Food),           data = nhanes3lead)  # ADRF of logBLL on Math, unconditional # inference adrf1 <- adrf(fit, treat = \"logBLL\")  # Differences among ADRF estimates at given points adrf1(logBLL = c(0, 1, 2)) |>   point_contrast() |>   summary() #>                           ADRF Point Contrasts #> ──────────────────────────────────────────────────────────────────────── #>                         Term Estimate Std. Error      t  P-value  CI Low #>  [logBLL = 1] - [logBLL = 0]  -0.4579     0.2662 -1.720   0.1962 -1.0810 #>  [logBLL = 2] - [logBLL = 0]  -1.4403     0.3074 -4.685 < 0.0001 -2.1601 #>  [logBLL = 2] - [logBLL = 1]  -0.9824     0.2610 -3.764   0.0005 -1.5935 #> ──────────────────────────────────────────────────────────────────────── #> Inference: unconditional, simultaneous #> Confidence level: 95% (t* = 2.341, df = 2473) #> Null value: 0"},{"path":"https://ngreifer.github.io/adrftools/reference/reference_curve.html","id":null,"dir":"Reference","previous_headings":"","what":"Contrast an effect curve with a reference point — reference_curve","title":"Contrast an effect curve with a reference point — reference_curve","text":"reference_curve() creates new effect curve contrast point given effect curve specified point along curve. new curve called \"reference effect curve\".","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/reference_curve.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Contrast an effect curve with a reference point — reference_curve","text":"","code":"reference_curve(x, reference)"},{"path":"https://ngreifer.github.io/adrftools/reference/reference_curve.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Contrast an effect curve with a reference point — reference_curve","text":"x effect_curve object; output call adrf() function modifies . reference numeric; value treatment use reference value.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/reference_curve.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Contrast an effect curve with a reference point — reference_curve","text":"object class reference_curve, inherits effect_curve, value supplied reference additional attribute.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/reference_curve.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Contrast an effect curve with a reference point — reference_curve","text":"value supplied reference added grid point reference effect curve using interpolation method described effect_curve. delta method used compute variance difference point along effect curve reference point.","code":""},{"path":[]},{"path":"https://ngreifer.github.io/adrftools/reference/reference_curve.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Contrast an effect curve with a reference point — reference_curve","text":"","code":"data(\"nhanes3lead\")  fit <- lm(Math ~ poly(logBLL, 5) *             (Male + Age + Race + PIR +                Enough_Food),           data = nhanes3lead)  # ADRF of logBLL on Math, unconditional # inference adrf1 <- adrf(fit, treat = \"logBLL\")  # Differences between ADRF estimates and estimate # at `logBLL = 0` ref1 <- reference_curve(adrf1, reference = 0)  ref1 #> An <effect_curve> object #>  #>  - curve type: ADRF reference #>  - response: Math #>  - treatment: logBLL #>    + range: -0.3567 to 2.4248 #>  - reference level: 0 #>  - inference: unconditional #>   # Plot the reference effect curve plot(ref1)   # Reference effect curve estimates at given points ref1(logBLL = c(0, 1, 2)) |>   summary() #>                  ADRF Reference Estimates #> ─────────────────────────────────────────────────────────── #>  logBLL Estimate Std. Error      t  P-value  CI Low CI High #>       0   0.0000     0.0000      .        .  0.0000  0.0000 #>       1  -0.4579     0.2662 -1.720   0.1461 -1.0437  0.1279 #>       2  -1.4403     0.3074 -4.685 < 0.0001 -2.1170 -0.7637 #> ─────────────────────────────────────────────────────────── #> Inference: unconditional, simultaneous #> Confidence level: 95% (t* = 2.201, df = 2473) #> Reference: logBLL = 0 | Null value: 0  # Test if reference effect curve is 0 (equivalent # to testing if ADRF is flat) summary(ref1) #>                   Omnibus Curve Test #> ─────────────────────────────────────────────────────── #> H₀: ADRF difference from reference (logBLL = 0) is 0 #>     for values of logBLL between -0.3567 and 2.4248 #>  #>   P-value #>  < 0.0001 #> ─────────────────────────────────────────────────────── #> Computed using the Imhof approximation"},{"path":"https://ngreifer.github.io/adrftools/reference/summary.curve_est.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute points on an effect curve — summary.curve_est","title":"Compute points on an effect curve — summary.curve_est","text":"summary() computes estimates confidence intervals specified points supplied effect curve.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/summary.curve_est.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute points on an effect curve — summary.curve_est","text":"","code":"# S3 method for class 'curve_est' summary(   object,   conf_level = 0.95,   simultaneous = TRUE,   null = NULL,   transform = TRUE,   ci.type = \"perc\",   df = NULL,   ... )  # S3 method for class 'curve_est' coef(object, ...)  # S3 method for class 'curve_est' vcov(object, ...)"},{"path":"https://ngreifer.github.io/adrftools/reference/summary.curve_est.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute points on an effect curve — summary.curve_est","text":"object effect_curve object; output call adrf() function modifies . conf_level desired confidence level. Set 0 omit confidence intervals. Default .95. simultaneous logical; whether computed p-values confidence intervals simultaneous (TRUE) pointwise (FALSE). Simultaneous (also known uniform) intervals jointly cover specified estimates desired confidence level, whereas pointwise confidence intervals cover estimate desired level. Simultaneous p-values inversions simultaneous confidence intervals. Default TRUE. See Details. null null value hypothesis tests. Default use null value 0 effect curve AMEF, curve contrast, reference effect curve, omit hypothesis tests otherwise. Set NA manually omit hypothesis tests. transform whether compute intervals perform tests transformed estimates. Allowable options include TRUE, FALSE, function specifying transformation. Ignored unless object ADRF. See Details. ci.type string; bootstrapping Bayesian inference used original effect curve, type confidence interval computed. bootstrapping, allowable options include \"perc\" percentile intervals, \"wald\" Wald intervals, options allowed fwb::summary.fwb() . simultaneous = TRUE, \"perc\" \"wald\" allowed. Bayesian models, allowable options include \"perc\" equi-tailed intervals \"wald\" Wald intervals. Default \"perc\". Ignored bootstrapping used model Bayesian. df \"denominator\" degrees freedom use tests critical test statistics confidence intervals. Default use residual degrees freedom original model linear model Inf otherwise. ... ignored.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/summary.curve_est.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute points on an effect curve — summary.curve_est","text":"summary() returns object class summary.curve_est, inherits curve_est. data.frame columns treatment, estimates, uncertainty measures (p-values, confidence intervals, etc.).","code":""},{"path":[]},{"path":"https://ngreifer.github.io/adrftools/reference/summary.curve_est.html","id":"transform","dir":"Reference","previous_headings":"","what":"Transform","title":"Compute points on an effect curve — summary.curve_est","text":"usual confidence intervals tests assume estimates along effect curve normally distributed (t-distributed df Inf). However, outcome bounded (e.g., probability bounded 0 1), assumption may valid ADRF finite samples. transform transforms estimates ones unbounded computes corresponding distribution transformed estimates using delta method. default, generalized linear model used outcome non-identity link function, estimates transformed link function unbounded scale. Note using linear predictor effect curve; simple transformation estimated points along curve already computed. Confidence intervals computed using transformed estimates back-transformed ensure within bounds outcome. null number, number also transformed. transform specified, standard errors reported (.e., standard errors used tests confidence intervals transformed estimates).","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/summary.curve_est.html","id":"simultaneous-confidence-intervals-and-tests","dir":"Reference","previous_headings":"","what":"Simultaneous confidence intervals and tests","title":"Compute points on an effect curve — summary.curve_est","text":"Simultaneous confidence intervals ensure estimates, just given individual point, contained within union confidence intervals given confidence level. wider pointwise intervals reflect covering multiple estimates, otherwise decrease true coverage rate specified. summary() uses \"sup-t\" simultaneous confidence interval, smallest one-parameter interval covers estimates desired rate. Simultaneous hypothesis tests performed inverting simultaneous confidence intervals; p-value test complement smallest confidence level simultaneous confidence intervals accounting tests contains null value. widths confidence intervals p-values depend many estimates computed.","code":""},{"path":[]},{"path":"https://ngreifer.github.io/adrftools/reference/summary.curve_est.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute points on an effect curve — summary.curve_est","text":"","code":"data(\"nhanes3lead\")  fit <- glm(Block >= 12 ~ poly(logBLL, 3) *              Male * (Age + Race + PIR + NICU +                        Smoke_Pregnant),            data = nhanes3lead,            family = binomial)  # ADRF of logBLL on P(Block >= 12) adrf1 <- adrf(fit, treat = \"logBLL\")  # Estimates along ADRF with simultaneous CIs computed # from transformed estimates adrf1(logBLL = c(0, 1, 2)) |>   summary() #>         ADRF Estimates #> ─────────────────────────────── #>  logBLL Estimate CI Low CI High #>       0   0.2274 0.1867  0.2740 #>       1   0.1925 0.1672  0.2206 #>       2   0.0739 0.0386  0.1368 #> ─────────────────────────────── #> Inference: unconditional, simultaneous #> Confidence level: 95% (z* = 2.386)  # Estimates along ADRF with pointwise CIs computed # from transformed estimates adrf1(logBLL = c(0, 1, 2)) |>   summary(simultaneous = FALSE) #>         ADRF Estimates #> ─────────────────────────────── #>  logBLL Estimate CI Low CI High #>       0   0.2274 0.1936  0.2653 #>       1   0.1925 0.1715  0.2154 #>       2   0.0739 0.0434  0.1230 #> ─────────────────────────────── #> Inference: unconditional, pointwise #> Confidence level: 95% (z* = 1.96)  # Estimates along ADRF with simultaneous CIs computed # from original estimates adrf1(logBLL = c(0, 1, 2)) |>   summary(transform = FALSE) #>               ADRF Estimates #> ────────────────────────────────────────── #>  logBLL Estimate Std. Error CI Low CI High #>       0   0.2274     0.0183 0.1838  0.2711 #>       1   0.1925     0.0112 0.1658  0.2192 #>       2   0.0739     0.0197 0.0269  0.1209 #> ────────────────────────────────────────── #> Inference: unconditional, simultaneous #> Confidence level: 95% (z* = 2.386)  # Estimates along ADRF with simultaneous CIs computed # from transformed estimates, hypothesis tests against # null of .1 adrf1(logBLL = c(0, 1, 2)) |>   summary(null = .1) #>                 ADRF Estimates #> ─────────────────────────────────────────────── #>  logBLL Estimate      z  P-value CI Low CI High #>       0   0.2274  9.349 < 0.0001 0.1867  0.2740 #>       1   0.1925 10.599 < 0.0001 0.1672  0.2206 #>       2   0.0739 -1.151   0.5741 0.0386  0.1368 #> ─────────────────────────────────────────────── #> Inference: unconditional, simultaneous #> Confidence level: 95% (z* = 2.386) #> Null value: -2.19722457733622"},{"path":"https://ngreifer.github.io/adrftools/reference/summary.effect_curve.html","id":null,"dir":"Reference","previous_headings":"","what":"Test omnibus hypotheses about an effect curves — summary.effect_curve","title":"Test omnibus hypotheses about an effect curves — summary.effect_curve","text":"summary() tests omnibus hypothesis effect curve. example, can used test ADRF flat, contrast two ADRFs 0 everywhere, AMEF 0 everywhere.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/summary.effect_curve.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Test omnibus hypotheses about an effect curves — summary.effect_curve","text":"","code":"# S3 method for class 'effect_curve' summary(   object,   hypothesis,   method,   subset = NULL,   transform = TRUE,   df = NULL,   nsim = 1e+06,   ... )  # S3 method for class 'summary.effect_curve' print(x, digits = max(4L, getOption(\"digits\") - 3L), ...)"},{"path":"https://ngreifer.github.io/adrftools/reference/summary.effect_curve.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Test omnibus hypotheses about an effect curves — summary.effect_curve","text":"object object class effect_curve; result call adrf() function modifies . hypothesis hypothesis tested. Allowable options include \"flat\" (default), \"linear\", \"quadratic\", \"cubic\", one-sided formula corresponding projection model, single number (e.g., 0). See Details. default \"flat\" ADRFs 0 otherwise. method string; method used compute p-value test. Allowable options include \"sim\" simulation-based, \"imhof\" Imhof's approximation, \"davies\" Davies's approximation, \"liu\" Liu's approximation, \"satterthwaite\" Satterthwaite's approximation, \"saddlepoint\" saddlepoint approximation. Default \"imhof\" CompQuadForm package installed, otherwise \"saddlepoint\" survey package installed, \"sim\" otherwise. See Details. subset optional logical expression indicating subset subgroups perform tests. Can used supplied original call adrf(), refer variables defining subgroups. transform whether perform test transformed estimates. Allowable options include TRUE, FALSE, function specifying transformation. Ignored unless object ADRF object. See Details. df \"denominator\" degrees freedom use tests. Default use residual degrees freedom original model linear model Inf otherwise. nsim method \"sim\", number iterations used simulate p-values. Higher numbers give accurate p-values subject less Monte Carlo error slower require memory. Default 1,000,000. ... method \"imhof\", \"davies\", \"liu\", arguments passed CompQuadForm::imhof() , CompQuadForm::davies() , CompQuadForm::liu() , respectively. x summary.effect_curve object. digits numeric; number digits print.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/summary.effect_curve.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Test omnibus hypotheses about an effect curves — summary.effect_curve","text":"object class \"summary.effect_curve\", data.frame column p-value , stratified effect curves contrasts thereof, additional columns identifying subset p-value refers.","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/summary.effect_curve.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Test omnibus hypotheses about an effect curves — summary.effect_curve","text":"summary() performs omnibus test effect curve. hypothesis tested determined argument \"hypothesis\". supplied single number, summary() tests whether values effect curve equal number. supplied one-sided formula, summary() tests whether projection effect curve model onto model represented formula sufficient describe effect curve. test tests whether residuals around projection equal 0, incorporating uncertainty estimating effect curve. See curve_projection() information curve projection uncertainty residuals computed. \"flat\" tests whether values curve equal (.e., whether curve flat), without specifying value equal . equivalent testing whether variance around mean estimate different 0 whether intercept-projection model sufficient. \"linear\" tests whether curve linear, .e., whether residuals around linear projection curve 0. \"quadratic\" \"cubic\" test whether curve quadratic cubic, respectively, using method. Rejecting null hypothesis means curve complicated specified model. example, rejecting null hypothesis curve linear implies curve nonlinear (, therefore, flat either). test involves computing test statistic, specifying distribution null hypothesis, computing p-value using compliment cumulative density function distribution evaluated test statistic value. test statistic depends \"hypothesis\". hypothesis equal constant, say, \\(c\\), test statistic $$T^* = \\int_\\mathcal{} (\\theta() - c)^2 \\ da$$ Otherwise, test statistic $$T^* = \\iint_\\mathcal{} (\\theta() - \\hat{\\theta}_0())^2 \\ da$$ \\(\\hat{\\theta}_0\\) projection \\(\\theta()\\) onto null subspace specified hypothesis. can approximated quadratic form, \\(T=\\mathbf{\\Theta}'\\mathbf{W}\\mathbf{\\Theta}\\) \\(\\mathbf{\\Theta}\\) vector estimates evaluation points along curve \\(\\mathbf{W}\\) diagonal matrix weights implementing trapezoidal approximation integral. null hypothesis \\(T=0\\), approximates null hypothesis \\(T^*=0\\). allowable options method corresponds method approximating distribution \\(T\\) null hypothesis: \"sim\" simulates null distribution simulating multivariate normal distribution null hypothesis computing test statistic simulation. p-value proportion simulated estimates greater observed test statistic. df Inf, simulation done multivariate t-distribution. \"imhof\", \"davies\", \"liu\" assume test statistic follows generalized \\(\\chi^2\\)-distribution approximate CDF numerically. \"imhof\" tends accurate recommended. methods require CompQuadForm package installed. \"satterthwaite\" also assumes test statistic follows generalized \\(\\chi^2\\)-distribution, distribution approximated using scaled F-distribution first two moments. \"saddlepoint\" also assumes test statistic follows generalized \\(\\chi^2\\)-distribution, distribution approximated using saddlepoint method implemented survey::pFsum() . method requires survey package installed. general, recommend using method = \"imhof\", though requires CompQuadForm installed (default ). method = \"saddlepoint\" also shown quite accurate fast. using \"sim\", increasing nsim improves accuracy p-value reducing Monte Carlo error. default value 1e6 ensures simulated p-value within .0005 true p-value least 98\\","code":""},{"path":"https://ngreifer.github.io/adrftools/reference/summary.effect_curve.html","id":"transform","dir":"Reference","previous_headings":"","what":"Transform","title":"Test omnibus hypotheses about an effect curves — summary.effect_curve","text":"effect curve ADRF outcomes bounded (e.g., probability 0 1), transform argument can specified, changes details tests. tests assume estimates along effect curve normally distributed (t-distributed df Inf). However, outcome bounded (e.g., probability bounded 0 1), assumption may valid ADRF finite samples. transform transforms estimates ones unbounded computes corresponding distribution transformed estimates using delta method. default, generalized linear model used outcome non-identity link function, estimates transformed link function unbounded scale. Note using linear predictor effect curve; simple transformation estimated points along curve already computed. hypothesis number, number also transformed. Tests transformed untransformed ADRFs correspond different hypotheses; difference simply matter appropriate distribution statistic. example, binary outcome model logistic transformation, testing transformed ADRF linear corresponds testing whether ADRF sigmoid function, whereas testing untransformed ADRF linear corresponds testing whether ADRF straight line. choices correspond projection ADRF formed; see curve_projection() details. See Examples example binary outcome. example, evidence reject transformed ADRF linear one groups, indicating sigmoid function sufficient describing ADRF, indeterminate evidence (.05) reject untransformed ADRF linear either group, indicating linear function sufficient describing ADRF (least treatment range examined).","code":""},{"path":[]},{"path":"https://ngreifer.github.io/adrftools/reference/summary.effect_curve.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Test omnibus hypotheses about an effect curves — summary.effect_curve","text":"","code":"data(\"nhanes3lead\")  fit <- glm(Block >= 12 ~ poly(logBLL, 3) *              Male * (Age + Race + PIR + NICU +                        Smoke_Pregnant),            data = nhanes3lead,            family = binomial)  # ADRFs of logBLL on P(Block >= 12) within # groups defined by `Male` adrf1 <- adrf(fit, treat = \"logBLL\",               by = ~Male)  adrf1 #> An <effect_curve> object #>  #>  - curve type: ADRF #>  - response: Block >= 12 #>  - treatment: logBLL #>    + range: -0.3567 to 2.4248 #>  - by: Male #>  - inference: unconditional #>   # Test if ADRFs are flat summary(adrf1) #>                   Omnibus Curve Test #> ─────────────────────────────────────────────────────── #> H₀: ADRF is flat (transformed) for values of logBLL #>     between -0.3567 and 2.4248 #>  #>  Male  P-value #>     0 < 0.0001 #>     1 < 0.0001 #> ─────────────────────────────────────────────────────── #> Computed using the Imhof approximation  # Test if logit-transformed ADRFs are linear # (i.e., if ADRFs have sigmoid shape) summary(adrf1, hypothesis = \"linear\") #>                   Omnibus Curve Test #> ─────────────────────────────────────────────────────── #> H₀: ADRF is linear (transformed) for values of logBLL #>     between -0.3567 and 2.4248 #>  #>  Male P-value #>     0  0.1644 #>     1  0.0189 #> ─────────────────────────────────────────────────────── #> Computed using the Imhof approximation # summary(adrf1, hypothesis = ~logBLL) # same test  proj1 <- curve_projection(adrf1, \"linear\")  plot(adrf1, proj = proj1, conf_level = 0)   # Test if un-transformed ADRFs are linear summary(adrf1, hypothesis = \"linear\",         transform = FALSE) #>                   Omnibus Curve Test #> ─────────────────────────────────────────────────────── #> H₀: ADRF is linear for values of logBLL between #>     -0.3567 and 2.4248 #>  #>  Male P-value #>     0  0.4736 #>     1  0.0903 #> ─────────────────────────────────────────────────────── #> Computed using the Imhof approximation  proj2 <- curve_projection(adrf1, \"linear\",                           transform = FALSE)  plot(adrf1, proj = proj2, conf_level = 0)   ## Test if ADRFs differ from each other by ## testing if the ADRF contrast is 0 curve_contrast(adrf1) |>   summary() #>                   Omnibus Curve Test #> ─────────────────────────────────────────────────────── #> H₀: ADRF contrast is 0 for values of logBLL between #>     -0.3567 and 2.4248 #>  #>                 Contrast  P-value #>  [Male = 1] - [Male = 0] < 0.0001 #> ─────────────────────────────────────────────────────── #> Computed using the Imhof approximation"},{"path":"https://ngreifer.github.io/adrftools/news/index.html","id":"adrftools-010","dir":"Changelog","previous_headings":"","what":"adrftools 0.1.0","title":"adrftools 0.1.0","text":"Initial CRAN submission.","code":""}]
