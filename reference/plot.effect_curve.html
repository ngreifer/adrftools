<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot an effect curve — plot.effect_curve • adrftools</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot an effect curve — plot.effect_curve"><meta name="description" content="plot() plots an effect curve and its confidence band."><meta property="og:description" content="plot() plots an effect curve and its confidence band."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">adrftools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/adrftools.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ngreifer/adrftools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot an effect curve</h1>
      <small class="dont-index">Source: <a href="https://github.com/ngreifer/adrftools/blob/main/R/plot.effect_curve.R" class="external-link"><code>R/plot.effect_curve.R</code></a></small>
      <div class="d-none name"><code>plot.effect_curve.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> plots an effect curve and its confidence band.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'effect_curve'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  conf_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  simultaneous <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  null <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  proj <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  transform <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ci.type <span class="op">=</span> <span class="st">"perc"</span>,</span>
<span>  df <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>an <code>effect_curve</code> object; the output of a call to <code><a href="adrf.html">adrf()</a></code> or functions that modify it.</p></dd>


<dt id="arg-conf-level">conf_level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>the desired confidence level. Default is .95 for 95% confidence bands.</p></dd>


<dt id="arg-simultaneous">simultaneous<a class="anchor" aria-label="anchor" href="#arg-simultaneous"></a></dt>
<dd><p><code>logical</code>; whether the computed confidence bands should be simultaneous (<code>TRUE</code>) or pointwise (<code>FALSE</code>). Simultaneous (also known as uniform) bands cover the full line at the desired confidence level, whereas pointwise confidence bands only cover each point at the desired level. Default is <code>TRUE</code>. See Details.</p></dd>


<dt id="arg-null">null<a class="anchor" aria-label="anchor" href="#arg-null"></a></dt>
<dd><p>the value at which to plot a horizontal reference line. Default is to plot a line with a y-intercept of 0 when the effect curve is an AMEF, a curve contrast, or a reference effect curve, and to omit a line otherwise. Set to <code>NA</code> to manually omit the line.</p></dd>


<dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>an optional logical expression indicating the subset of the subgroups to plot. Can only be used when <code>by</code> was supplied to the original call to <code><a href="adrf.html">adrf()</a></code>, and only to refer to variables defining subgroups.</p></dd>


<dt id="arg-proj">proj<a class="anchor" aria-label="anchor" href="#arg-proj"></a></dt>
<dd><p>an optional <code>curve_projection</code> object, the output of a call to <code><a href="curve_projection.html">curve_projection()</a></code>. Supplying this adds the projection curve to the effect curve plot.</p></dd>


<dt id="arg-transform">transform<a class="anchor" aria-label="anchor" href="#arg-transform"></a></dt>
<dd><p>whether to compute intervals on the transformed estimates. Allowable options include <code>TRUE</code>, <code>FALSE</code>, or a function specifying a transformation. Ignored unless <code>x</code> is an ADRF. See Details.</p></dd>


<dt id="arg-ci-type">ci.type<a class="anchor" aria-label="anchor" href="#arg-ci-type"></a></dt>
<dd><p>string; when bootstrapping is used in the original effect curve, what type of confidence interval is to be computed. Allowable options include <code>"perc"</code> for percentile intervals, <code>"wald"</code> for Wald intervals, and other options allowed by <code><a href="https://ngreifer.github.io/fwb/reference/summary.fwb.html" class="external-link">fwb::summary.fwb()</a></code>
. When <code>simultaneous = TRUE</code>, only <code>"perc"</code> and <code>"wald"</code> are allowed. Default is <code>"perc"</code>. Ignored when bootstrapping is not used.</p></dd>


<dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>the "denominator" degrees of freedom to use for the critical test statistics for confidence bands. Default is to use the residual degrees of freedom from the original model if it is a linear model and <code>Inf</code> otherwise.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>ignored.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>ggplot</code> object that can modified using functions in <span class="pkg">ggplot2</span>. Below are some common tasks and instructions to perform them. Note all should be run after running <code><a href="https://ggplot2.tidyverse.org" class="external-link">library("ggplot2")</a></code>.</p>
<ul><li><p>Change the position of the legend:
</p><div class="sourceCode"><pre><code><span></span>
<span><span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"{POSITION}"</span><span class="op">)</span></span></code></pre></div></li>
<li><p>Remove the legend:
</p><div class="sourceCode"><pre><code><span></span>
<span><span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div></li>
<li><p>Change the color of the plotted line:
</p><div class="sourceCode"><pre><code>
theme(geom = element_geom(ink = "{COLOR}")</code></pre></div></li>
<li><p>Change the color scheme of the plotted lines:
</p><div class="sourceCode"><pre><code><span></span>
<span><span class="fu">scale_color_brewer</span><span class="op">(</span>aesthetics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"color"</span>, <span class="st">"fill"</span><span class="op">)</span>,</span>
<span>                   palette <span class="op">=</span> <span class="st">"{PALETTE}"</span><span class="op">)</span></span></code></pre></div></li>
<li><p>Change the title, subtitle, or axis labels:
</p><div class="sourceCode"><pre><code><span></span>
<span><span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"{TITLE}"</span>, subtitle <span class="op">=</span> <span class="st">"{SUBTITLE}"</span>,</span>
<span>     x <span class="op">=</span> <span class="st">"{X-AXIS}"</span>, y <span class="op">=</span> <span class="st">"{Y-AXIS}"</span><span class="op">)</span></span></code></pre></div></li>
<li><p>Change the y-axis range:
</p><div class="sourceCode"><pre><code><span></span>
<span><span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">{</span><span class="va">LOWER</span><span class="op">}</span>, <span class="op">{</span><span class="va">UPPER</span><span class="op">}</span><span class="op">)</span>,</span>
<span>                expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div></li>
</ul><p>Strings in brackets are to be changed by the user. Refer to the <a href="https://CRAN.R-project.org/package=ggplot2" class="external-link"><span class="pkg">ggplot2</span></a> documentation for other options.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> displays the effect curve in a plot. The solid line corresponds to the effect curve and the ribbon around it corresponds to its confidence band. When <code>null</code> is not <code>NA</code>, an additional flat line at <code>null</code> is displayed. When <code>proj</code> is supplied, a dashed line corresponding to the projection is added.</p>
<p>When <code>by</code> is supplied to <code><a href="adrf.html">adrf()</a></code>, <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> produces an effect curve plot for each subgroup. When <code>x</code> is the output of a call to <code><a href="curve_contrast.html">curve_contrast()</a></code>, <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> produces an effect curve plot for each treatment contrast.</p><div class="section">
<h3 id="transform">Transform<a class="anchor" aria-label="anchor" href="#transform"></a></h3>


<p>The usual confidence bands assume the estimates along the effect curve are normally distributed (or t-distributed when <code>df</code> is not <code>Inf</code>). However, when the outcome is bounded (e.g., a probability bounded between 0 and 1), this assumption may not be valid for the ADRF in finite samples. <code>transform</code> transforms the estimates to ones that are unbounded and computes the corresponding distribution of transformed estimates using the delta method. By default, if a generalized linear model is used for the outcome with a non-identity link function, the estimates are transformed by the link function to be on an unbounded scale. Note this is not the same as using the linear predictor for the effect curve; this is simple a transformation of the estimated points along the curve already computed. Confidence bands are computed using the transformed estimates before being back-transformed to ensure they are within the bounds of the outcome.</p>
</div>

<div class="section">
<h3 id="simultaneous-confidence-bands">Simultaneous confidence bands<a class="anchor" aria-label="anchor" href="#simultaneous-confidence-bands"></a></h3>


<p>Simultaneous confidence bands ensure the whole effect curve, not just a given individual point, is contained within the band at the given confidence level. These are wider than pointwise bands to reflect that they are covering multiple estimates, which otherwise would decrease the true coverage rate from that specified. <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> uses the "sup-t" simultaneous confidence band, which is the smallest one-parameter band that covers the whole effect curve at the desired rate.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="adrf.html">adrf()</a></code> for computing the ADRF</p></li>
<li><p><code><a href="summary.effect_curve.html">summary.effect_curve()</a></code> for testing hypotheses about an effect curve</p></li>
</ul></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"nhanes3lead"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Block</span> <span class="op">&gt;=</span> <span class="fl">12</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">logBLL</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">*</span></span></span>
<span class="r-in"><span>             <span class="va">Male</span> <span class="op">*</span> <span class="op">(</span><span class="va">Age</span> <span class="op">+</span> <span class="va">Race</span> <span class="op">+</span> <span class="va">PIR</span> <span class="op">+</span> <span class="va">NICU</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                       <span class="va">Smoke_Pregnant</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           data <span class="op">=</span> <span class="va">nhanes3lead</span>,</span></span>
<span class="r-in"><span>           family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ADRF of logBLL on P(Block &gt;= 12)</span></span></span>
<span class="r-in"><span><span class="va">adrf1</span> <span class="op">&lt;-</span> <span class="fu"><a href="adrf.html">adrf</a></span><span class="op">(</span><span class="va">fit</span>, treat <span class="op">=</span> <span class="st">"logBLL"</span>,</span></span>
<span class="r-in"><span>              n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="co">#using 50 to speed up examples</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot the ADRF; simultaneous inference,</span></span></span>
<span class="r-in"><span><span class="co"># CIs computed on transformed estimates</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">adrf1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.effect_curve-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot the ADRF; simultaneous inference,</span></span></span>
<span class="r-in"><span><span class="co"># CIs computed on original estimates</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">adrf1</span>, transform <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.effect_curve-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot the ADRF; pointwise inference</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">adrf1</span>, simultaneous <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.effect_curve-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ADRF within subgroups</span></span></span>
<span class="r-in"><span><span class="va">adrf2</span> <span class="op">&lt;-</span> <span class="fu"><a href="adrf.html">adrf</a></span><span class="op">(</span><span class="va">fit</span>, treat <span class="op">=</span> <span class="st">"logBLL"</span>,</span></span>
<span class="r-in"><span>              by <span class="op">=</span> <span class="op">~</span><span class="va">Male</span>, n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot subgroup ADRFs</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">adrf2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.effect_curve-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot ADRF in one subgroup</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">adrf2</span>, subset <span class="op">=</span> <span class="va">Male</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.effect_curve-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ADRF contrast</span></span></span>
<span class="r-in"><span><span class="va">adrf_contrast</span> <span class="op">&lt;-</span> <span class="fu"><a href="curve_contrast.html">curve_contrast</a></span><span class="op">(</span><span class="va">adrf2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">adrf_contrast</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.effect_curve-6.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Noah Greifer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

