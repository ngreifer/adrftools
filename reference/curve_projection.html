<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Project an effect curve onto a simpler model — curve_projection • adrftools</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Project an effect curve onto a simpler model — curve_projection"><meta name="description" content="curve_projection() produces a projection of an estimated effect curve onto a specified linear model that is a function only of the treatment to act as a more interpretable summary of the original effect curve."><meta property="og:description" content="curve_projection() produces a projection of an estimated effect curve onto a specified linear model that is a function only of the treatment to act as a more interpretable summary of the original effect curve."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">adrftools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/adrftools.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ngreifer/adrftools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Project an effect curve onto a simpler model</h1>
      <small class="dont-index">Source: <a href="https://github.com/ngreifer/adrftools/blob/main/R/curve_projection.R" class="external-link"><code>R/curve_projection.R</code></a></small>
      <div class="d-none name"><code>curve_projection.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>curve_projection()</code> produces a projection of an estimated effect curve onto a specified linear model that is a function only of the treatment to act as a more interpretable summary of the original effect curve.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">curve_projection</span><span class="op">(</span><span class="va">x</span>, <span class="va">model</span>, transform <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'curve_projection'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  conf_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  null <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  df <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ci.type <span class="op">=</span> <span class="st">"perc"</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'curve_projection'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'curve_projection'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'curve_projection'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">object2</span>, df <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>an <code><a href="effect_curve.html">effect_curve</a></code> object; the output of a call to <code><a href="adrf.html">adrf()</a></code>.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>the projection model to be fit. Can be a one-sided formula corresponding to the projection model or one of the following strings: <code>"flat"</code>, <code>"linear"</code>, <code>"quadratic"</code>, <code>"cubic"</code>.</p></dd>


<dt id="arg-transform">transform<a class="anchor" aria-label="anchor" href="#arg-transform"></a></dt>
<dd><p>whether to compute the projection using a transformation of the linear predictor. Allowable options include <code>TRUE</code>, <code>FALSE</code>, or a function specifying a transformation (of which the inverse is used as the inverse link of the projection model). Ignored unless <code>object</code> is an ADRF. See Details.</p></dd>


<dt id="arg-object-object-">object, object2<a class="anchor" aria-label="anchor" href="#arg-object-object-"></a></dt>
<dd><p>a <code>curve_projection</code> object; the output of a call to <code>curve_projection()</code>.</p></dd>


<dt id="arg-conf-level">conf_level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>the desired confidence level. Set to 0 to omit confidence intervals. Default is .95.</p></dd>


<dt id="arg-null">null<a class="anchor" aria-label="anchor" href="#arg-null"></a></dt>
<dd><p>the null value for hypothesis test. Default is 0. Set to <code>NA</code> to omit tests.</p></dd>


<dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>the "denominator" degrees of freedom to use for the test. Default is to use the residual degrees of freedom from the original model if it is a linear model (in which case an F-test is used) and <code>Inf</code> otherwise (in which case a \(\chi^2\) test is used).</p></dd>


<dt id="arg-ci-type">ci.type<a class="anchor" aria-label="anchor" href="#arg-ci-type"></a></dt>
<dd><p>string; when bootstrapping or Bayesian inference is used in the original effect curve, which type of confidence interval is to be computed. For bootstrapping, allowable options include <code>"perc"</code> for percentile intervals, <code>"wald"</code> for Wald intervals, and other options allowed by <code><a href="https://ngreifer.github.io/fwb/reference/summary.fwb.html" class="external-link">fwb::summary.fwb()</a></code>
. When <code>simultaneous = TRUE</code>, only <code>"perc"</code> and <code>"wald"</code> are allowed. For Bayesian models, allowable options include <code>"perc"</code> for equi-tailed intervals and <code>"wald"</code> for Wald intervals. Default is <code>"perc"</code>. Ignored when bootstrapping is not used and the model is not Bayesian.</p></dd>


<dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>an optional logical expression indicating the subset of subgroups for which to compute the projection. Can only be used when <code>by</code> was supplied to the original call to <code><a href="adrf.html">adrf()</a></code>, and only to refer to variables defining subgroups.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>ignored.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>curve_projection()</code> returns an <code>curve_projection</code> object, which inherits from <code><a href="effect_curve.html">effect_curve</a></code>. This object is a function that produces estimates of the effect curve projection when called with values of the treatment as inputs. See <code><a href="effect_curve.html">effect_curve</a></code> for details on calling this function.</p>
<p>The coefficients and covariance matrix of the fitted projection should be extracted with <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef()</a></code> and <code><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov()</a></code>, respectively. <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> produces the coefficients and quantities of interest for inference (test statistics, p-values, and confidence intervals). Using <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> on a <code>curve_projection</code> object plots the projection curve as if it was an effect curve; see <code><a href="plot.effect_curve.html">plot.effect_curve()</a></code> for adding the projection curve to the plot of the original effect curve.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The projection model can be thought of as a linear regression of the effect curve estimates on the treatment. Whereas the original effect curve may be complicated and nonlinear, the projection model can be simple and easily interpretable, though it must be understood as a summary of the original effect curve. For example, the original ADRF might have been computed from an outcome model that involves treatment splines, covariates, and treatment-covariate interactions. Though the ADRF is a univariable function (i.e., of only the treatment), it isn't described by a single set of parameters. The linear projection of the ADRF, though, could be a simple linear model, described by an intercept and the slope on treatment. Though only a rough approximation to the ADRF, the linear projection may be more easily interpreted. This concept is described in Neugebauer and van der Laan (2007).</p>
<p><code>curve_projection()</code> fits this projection model and accounts for the uncertainty in the estimates of the effect curve in computing uncertainty estimates for the projection model parameters. Because the true effect curve is continuous, the model is fit minimizing
$$\int_{a_\text{lower}}^{a_\text{upper}}{\left(\hat{\theta}(a)-\hat{\mathbf{\beta}} B(a) \right)^2 da}$$
where \(\hat{\theta}(a)\) is the effect curve estimate at treatment value \(a\), \(B(a)\) is the basis function representation of \(a\) (i.e., as specified in <code>model</code>), and \(\hat{\mathbf{\beta}}\) is the vector of projection parameters to be estimated. This integral is approximated using a trapezoidal Riemann sum over the effect curve grid points.</p>
<p>The covariance of the projection parameters can be computed using the delta method applied to the estimated covariance of the original effect curve estimates. When bootstrapping or posterior inference are used, the projection is applied to each bootstrap or posterior draw, respectively.</p><div class="section">
<h3 id="transform">Transform<a class="anchor" aria-label="anchor" href="#transform"></a></h3>


<p>When <code>transform</code> is specified, the projection minimizes the distance between the original effect curve and the transformed linear predictor; that is, it minimizes</p>
<p>$$\int_{a_\text{lower}}^{a_\text{upper}}{\left(\hat{\theta}(a)-f^{-1}\left(\hat{\mathbf{\beta}} B(a) \right) \right)^2 da}$$</p>
<p>where \(f^{-1}(y)\) is the inverse of the transformation supplied to <code>transform</code> (i.e., corresponding to the inverse link function of a generalized linear model), essentially using nonlinear least squares (NLS) to estimate the effect curve projection. This make the coefficients in the projection model correspond to the coefficients on the linear predictor \(\hat{\mathbf{\beta}} B(a)\). In this case, the projection is not simply a linear projection, but it may still be more interpretable than the original ADRF. For example, if the outcome model was originally fit using logistic regression and <code>transform = TRUE</code> in the call to <code>curve_projection()</code> with <code>model = "linear"</code>, the resulting projection would be a logistic curve governed by the intercept and slope of the linear predictor. See Examples for an example of this.</p>
<p>By default, <code>transform</code> is <code>TRUE</code>, which means that when the original outcome model had a <code>family</code> component (e.g., a generalized linear model) and an ADRF is supplied to <code>curve_projection()</code>, the link is automatically supplied to <code>transform</code> and the projection model will be a nonlinear function of the linear predictor. Set <code>transform</code> to <code>FALSE</code> to require that the projection curve be simply the linear predictor with no transformation. Note this can lead to invalid estimates when the outcome is bounded.</p>
</div>

<div class="section">
<h3 id="comparing-projection-models">Comparing projection models<a class="anchor" aria-label="anchor" href="#comparing-projection-models"></a></h3>


<p><code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova()</a></code> performs a Wald test comparing two nested projection models. The null hypothesis is that the simpler model is sufficient, i.e., that the coefficients on the terms in the larger model (supplied to <code>object</code>) that are not in the smaller model (supplied to <code>object2</code>) are all zero. Rejecting the null hypothesis implies that the larger model fits better.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Neugebauer, R., &amp; van der Laan, M. (2007). Nonparametric causal effects based on marginal structural models. <em>Journal of Statistical Planning and Inference</em>, 137(2), 419–434. <a href="https://doi.org//10.1016/j.jspi.2005.12.008" class="external-link">doi:/10.1016/j.jspi.2005.12.008</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="plot.effect_curve.html">plot.effect_curve()</a></code> for plotting the effect curve and its projection</p></li>
<li><p><code><a href="effect_curve.html">effect_curve</a></code> for computing point estimates along the effect curve projection</p></li>
<li><p><code><a href="summary.effect_curve.html">summary.effect_curve()</a></code> for testing hypotheses about the effect curve, such as whether a given projection is sufficient</p></li>
<li><p><code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova()</a></code> for comparing linear models</p></li>
</ul></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"nhanes3lead"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Math</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">logBLL</span>, <span class="fl">5</span><span class="op">)</span> <span class="op">*</span></span></span>
<span class="r-in"><span>            <span class="op">(</span><span class="va">Male</span> <span class="op">+</span> <span class="va">Age</span> <span class="op">+</span> <span class="va">Race</span> <span class="op">+</span> <span class="va">PIR</span> <span class="op">+</span></span></span>
<span class="r-in"><span>               <span class="va">Enough_Food</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          data <span class="op">=</span> <span class="va">nhanes3lead</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ADRF of logBLL on Math, unconditional</span></span></span>
<span class="r-in"><span><span class="co"># inference</span></span></span>
<span class="r-in"><span><span class="va">adrf1</span> <span class="op">&lt;-</span> <span class="fu"><a href="adrf.html">adrf</a></span><span class="op">(</span><span class="va">fit</span>, treat <span class="op">=</span> <span class="st">"logBLL"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Linear projection is sufficient for</span></span></span>
<span class="r-in"><span><span class="co"># characterizing the ADRF</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">adrf1</span>, hypothesis <span class="op">=</span> <span class="st">"linear"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Omnibus Curve Test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ───────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H₀: ADRF is linear for values of logBLL between</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     -0.3567 and 2.4248</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0.375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ───────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Computed using the Imhof approximation</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute the linear projection</span></span></span>
<span class="r-in"><span><span class="va">proj1</span> <span class="op">&lt;-</span> <span class="fu">curve_projection</span><span class="op">(</span><span class="va">adrf1</span>, <span class="st">"linear"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># proj1 &lt;- curve_projection(adrf1, ~logBLL) #same model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">proj1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An <span style="font-style: italic;">effect_curve</span> object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - curve type: ADRF projection</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - response: Math</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - treatment: logBLL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    + range: -0.3567 to 2.4248</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - projection model: ~logBLL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - inference: unconditional</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Use `plot()` (`?adrftools::plot.effect_curve()`) to plot</span> <span style="font-style: italic;">the curve, `summary()`</span> <span style="font-style: italic;">(`?adrftools::summary.effect_curve()`) to test the curve,</span> <span style="font-style: italic;">or `{object}(values)` (`?adrftools::effect_curve-class()`)</span> <span style="font-style: italic;">to compute estimates.</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Coefficients of the projection model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">proj1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)      logBLL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   8.5703241  -0.7198424 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">proj1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  ADRF Projection Coefficients</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ──────────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Term Estimate Std. Error     t  P-value CI Low CI High</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  (Intercept)     8.57     0.1494 57.37 &lt; 0.0001  8.277   8.863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       logBLL    -0.72     0.1424 -5.06 &lt; 0.0001 -0.999  -0.441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ──────────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Inference: unconditional</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Confidence level: 95% (t* = 1.961, df = 2473)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Null value: 0</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot the projection</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">proj1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="curve_projection-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot the projection over the ADRF</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">adrf1</span>, proj <span class="op">=</span> <span class="va">proj1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="curve_projection-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute a cubic projection</span></span></span>
<span class="r-in"><span><span class="va">proj2</span> <span class="op">&lt;-</span> <span class="fu">curve_projection</span><span class="op">(</span><span class="va">adrf1</span>, <span class="st">"cubic"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># proj2 &lt;- curve_projection(adrf1, ~poly(logBLL, 3)) #same model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare cubic to linear projection</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">proj2</span>, <span class="va">proj1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        Wald Test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ───────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 1: ~logBLL + I(logBLL^2) + I(logBLL^3)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 2: ~logBLL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H₀: Extra terms in Model 1 have coefficients equal to</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0 (i.e., Model 2 is sufficient)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  df      F P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2 1.3587  0.2572</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ───────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Inference: unconditional (df = 2473)</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Noah Greifer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

