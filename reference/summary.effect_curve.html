<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Test omnibus hypotheses about an effect curves — summary.effect_curve • adrftools</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Test omnibus hypotheses about an effect curves — summary.effect_curve"><meta name="description" content="summary() tests an omnibus hypothesis about an effect curve. For example, it can be used to test that the ADRF is flat, that the contrast between two ADRFs is 0 everywhere, or that the AMEF is 0 everywhere."><meta property="og:description" content="summary() tests an omnibus hypothesis about an effect curve. For example, it can be used to test that the ADRF is flat, that the contrast between two ADRFs is 0 everywhere, or that the AMEF is 0 everywhere."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">adrftools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/adrftools.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ngreifer/adrftools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Test omnibus hypotheses about an effect curves</h1>
      <small class="dont-index">Source: <a href="https://github.com/ngreifer/adrftools/blob/main/R/summary.effect_curve.R" class="external-link"><code>R/summary.effect_curve.R</code></a></small>
      <div class="d-none name"><code>summary.effect_curve.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> tests an omnibus hypothesis about an effect curve. For example, it can be used to test that the ADRF is flat, that the contrast between two ADRFs is 0 everywhere, or that the AMEF is 0 everywhere.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'effect_curve'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">hypothesis</span>,</span>
<span>  <span class="va">method</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  transform <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  df <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nsim <span class="op">=</span> <span class="fl">1e+06</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'summary.effect_curve'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">4L</span>, <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span> <span class="op">-</span> <span class="fl">3L</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>an object of class <code><a href="effect_curve.html">effect_curve</a></code>; the result of a call to <code><a href="adrf.html">adrf()</a></code> or a function that modifies it.</p></dd>


<dt id="arg-hypothesis">hypothesis<a class="anchor" aria-label="anchor" href="#arg-hypothesis"></a></dt>
<dd><p>the hypothesis to be tested. Allowable options include <code>"flat"</code> (the default), <code>"linear"</code>, <code>"quadratic"</code>, <code>"cubic"</code>, a one-sided formula corresponding to a projection model, or a single number (e.g., 0). See Details. The default is <code>"flat"</code> for ADRFs and 0 otherwise.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>string; the method used to compute the p-value of the test. Allowable options include <code>"sim"</code> for simulation-based, <code>"imhof"</code> for Imhof's approximation, <code>"davies"</code> for Davies's approximation, <code>"liu"</code> for Liu's approximation, <code>"satterthwaite"</code> for Satterthwaite's approximation, and <code>"saddlepoint"</code> for a saddlepoint approximation. Default is <code>"imhof"</code> when the <span class="pkg">CompQuadForm</span> package is installed, otherwise <code>"saddlepoint"</code> when the <span class="pkg">survey</span> package is installed, and <code>"sim"</code> otherwise. See Details.</p></dd>


<dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>an optional logical expression indicating the subset of the subgroups for which to perform tests. Can only be used when <code>by</code> was supplied to the original call to <code><a href="adrf.html">adrf()</a></code>, and only to refer to variables defining subgroups.</p></dd>


<dt id="arg-transform">transform<a class="anchor" aria-label="anchor" href="#arg-transform"></a></dt>
<dd><p>whether to perform the test on the transformed estimates. Allowable options include <code>TRUE</code>, <code>FALSE</code>, or a function specifying a transformation. Ignored unless <code>object</code> is an ADRF object. See Details.</p></dd>


<dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>the "denominator" degrees of freedom to use for the tests. Default is to use the residual degrees of freedom from the original model if it is a linear model and <code>Inf</code> otherwise.</p></dd>


<dt id="arg-nsim">nsim<a class="anchor" aria-label="anchor" href="#arg-nsim"></a></dt>
<dd><p>when <code>method</code> is <code>"sim"</code>, the number of iterations used to simulate the p-values. Higher numbers give more accurate p-values subject to less Monte Carlo error but are slower and require more memory. Default is 1,000,000.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>when <code>method</code> is <code>"imhof"</code>, <code>"davies"</code>, or <code>"liu"</code>, further arguments passed to <code><a href="https://rdrr.io/pkg/CompQuadForm/man/imhof.html" class="external-link">CompQuadForm::imhof()</a></code>, <code><a href="https://rdrr.io/pkg/CompQuadForm/man/davies.html" class="external-link">CompQuadForm::davies()</a></code>, or <code><a href="https://rdrr.io/pkg/CompQuadForm/man/liu.html" class="external-link">CompQuadForm::liu()</a></code>, respectively.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a <code>summary.effect_curve</code> object.</p></dd>


<dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>numeric; the number of digits to print.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>"summary.effect_curve"</code>, which is a data.frame with a column for the p-value and, for stratified effect curves or contrasts thereof, additional columns identifying the subset to which the p-value refers.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> performs an omnibus test for an effect curve. The hypothesis tested is determined by the argument to <code>"hypothesis"</code>. When supplied as a single number, <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> tests whether all values on the effect curve are equal to that number. When supplied as a one-sided formula, <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> tests whether the projection of the effect curve model onto the model represented in the formula is sufficient to describe the effect curve. The test itself tests whether the residuals around the projection are all equal to 0, incorporating the uncertainty in estimating the effect curve. See <code><a href="curve_projection.html">curve_projection()</a></code> for more information on how the curve projection and the uncertainty in the residuals are computed.</p>
<p><code>"flat"</code> tests whether all values on the curve are equal to each other (i.e., whether the curve is flat), without specifying what value they are equal to. This is equivalent to testing whether the variance around the mean estimate is different from 0 or whether an intercept-only projection model is sufficient. <code>"linear"</code> tests whether the curve is linear, i.e., whether the residuals around linear projection of the curve are all 0. <code>"quadratic"</code> and <code>"cubic"</code> test whether the curve is quadratic or cubic, respectively, using the same method.</p>
<p>Rejecting the null hypothesis means that the curve is more complicated than the specified model. For example, rejecting the null hypothesis that the curve is linear implies that the curve is nonlinear (and, therefore, not flat either).</p>
<p>The test involves computing a test statistic, specifying its distribution under the null hypothesis, and computing the p-value using the compliment of the cumulative density function of the distribution evaluated at the test statistic value. The test statistic depends on <code>"hypothesis"</code>. For <code>hypothesis</code> equal to a constant, say, \(c\), the test statistic is
$$T^* = \int_\mathcal{A} (\theta(a) - c)^2 \ da$$
Otherwise, the test statistic is
$$T^* = \iint_\mathcal{A} (\theta(a) - \hat{\theta}_0(a))^2 \ da$$
where \(\hat{\theta}_0\) is the projection of \(\theta(a)\) onto the null subspace specified by <code>hypothesis</code>.</p>
<p>Each of these can be approximated as a quadratic form, \(T=\mathbf{\Theta}'\mathbf{W}\mathbf{\Theta}\) where \(\mathbf{\Theta}\) is a vector of estimates at evaluation points along the curve and \(\mathbf{W}\) is a diagonal matrix of weights implementing a trapezoidal approximation to the integral. The null hypothesis is that \(T=0\), which approximates the null hypothesis that \(T^*=0\). Each of the allowable options to <code>method</code> corresponds to a method of approximating the distribution of \(T\) under the null hypothesis:</p><ul><li><p><code>"sim"</code> simulates the null distribution by simulating from a multivariate normal distribution under the null hypothesis and computing the test statistic in each simulation. The p-value is the proportion of simulated estimates greater than the observed test statistic. When <code>df</code> is not <code>Inf</code>, the simulation is done from a multivariate t-distribution.</p></li>
<li><p><code>"imhof"</code>, <code>"davies"</code>, and <code>"liu"</code> assume the test statistic follows a generalized \(\chi^2\)-distribution and approximate its CDF numerically. <code>"imhof"</code> tends to be the most accurate and is recommended. These methods require the <a href="https://CRAN.R-project.org/package=CompQuadForm" class="external-link"><span class="pkg">CompQuadForm</span></a> package to be installed.</p></li>
<li><p><code>"satterthwaite"</code> also assumes the test statistic follows a generalized \(\chi^2\)-distribution, but this distribution is approximated using a scaled F-distribution with the same first two moments.</p></li>
<li><p><code>"saddlepoint"</code> also assumes the test statistic follows a generalized \(\chi^2\)-distribution, and this distribution is approximated using a saddlepoint method as implemented in <code><a href="https://rdrr.io/pkg/survey/man/pchisqsum.html" class="external-link">survey::pFsum()</a></code>. This method requires the <a href="https://CRAN.R-project.org/package=survey" class="external-link"><span class="pkg">survey</span></a> package to be installed.</p></li>
</ul><p>In general, we recommend using <code>method = "imhof"</code>, though this requires <span class="pkg">CompQuadForm</span> to be installed (and is the default when it is). <code>method = "saddlepoint"</code> has also been shown to be quite accurate and very fast. When using <code>"sim"</code>, increasing <code>nsim</code> improves the accuracy of the p-value by reducing Monte Carlo error. The default value of <code>1e6</code> ensures that the simulated p-value is within .0005 of the true p-value with at least 98\<!-- % confidence for p-values less than .05. For greater precision at higher p-value thresholds, \code{nsim} should be increased. The other methods exist primarily for comparison purposes. \code{"satterthwaite"} is particularly fast and doesn't require any other packages, but it can be somewhat inaccurate. --></p><div class="section">
<h3 id="transform">Transform<a class="anchor" aria-label="anchor" href="#transform"></a></h3>


<p>When the effect curve is an ADRF and the outcomes are bounded (e.g., a probability between 0 and 1), the <code>transform</code> argument can be specified, which changes the details of the tests.</p>
<p>The tests above assume the estimates along the effect curve are normally distributed (or t-distributed when <code>df</code> is not <code>Inf</code>). However, when the outcome is bounded (e.g., a probability bounded between 0 and 1), this assumption may not be valid for the ADRF in finite samples. <code>transform</code> transforms the estimates to ones that are unbounded and computes the corresponding distribution of transformed estimates using the delta method. By default, if a generalized linear model is used for the outcome with a non-identity link function, the estimates are transformed by the link function to be on an unbounded scale. Note this is not the same as using the linear predictor for the effect curve; this is simple a transformation of the estimated points along the curve already computed. When <code>hypothesis</code> is a number, that number is also transformed.</p>
<p>Tests on the transformed and untransformed ADRFs correspond to different hypotheses; the difference is not simply a matter of the appropriate distribution of the statistic. For example, for binary outcome model with a logistic transformation, testing that the transformed ADRF is linear corresponds to testing whether the ADRF is a sigmoid function, whereas testing that the untransformed ADRF is linear corresponds to testing whether the ADRF is a straight line. These choices correspond to how the projection of the ADRF is formed; see <code><a href="curve_projection.html">curve_projection()</a></code> for details. See Examples for an example with a binary outcome. In the example, there is evidence to reject that the transformed ADRF is linear for one of the groups, indicating that a sigmoid function is not sufficient for describing the ADRF, but there is indeterminate evidence (at the .05) to reject that the untransformed ADRF is linear for either group, indicating that a linear function is sufficient for describing the ADRF (at least in the treatment range examined).</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="adrf.html">adrf()</a></code> for computing the ADRF</p></li>
<li><p><code><a href="summary.curve_est.html">summary.curve_est()</a></code> for performing inference on individual points on an effect curve</p></li>
<li><p><code><a href="plot.effect_curve.html">plot.effect_curve()</a></code> for plotting the effect curve</p></li>
<li><p><code><a href="curve_projection.html">curve_projection()</a></code> for projecting a simpler model onto an effect curve</p></li>
</ul></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"nhanes3lead"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Block</span> <span class="op">&gt;=</span> <span class="fl">12</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">logBLL</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">*</span></span></span>
<span class="r-in"><span>             <span class="va">Male</span> <span class="op">*</span> <span class="op">(</span><span class="va">Age</span> <span class="op">+</span> <span class="va">Race</span> <span class="op">+</span> <span class="va">PIR</span> <span class="op">+</span> <span class="va">NICU</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                       <span class="va">Smoke_Pregnant</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           data <span class="op">=</span> <span class="va">nhanes3lead</span>,</span></span>
<span class="r-in"><span>           family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ADRFs of logBLL on P(Block &gt;= 12) within</span></span></span>
<span class="r-in"><span><span class="co"># groups defined by `Male`</span></span></span>
<span class="r-in"><span><span class="va">adrf1</span> <span class="op">&lt;-</span> <span class="fu"><a href="adrf.html">adrf</a></span><span class="op">(</span><span class="va">fit</span>, treat <span class="op">=</span> <span class="st">"logBLL"</span>,</span></span>
<span class="r-in"><span>              by <span class="op">=</span> <span class="op">~</span><span class="va">Male</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">adrf1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An <span style="font-style: italic;">effect_curve</span> object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - curve type: ADRF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - response: Block &gt;= 12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - treatment: logBLL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    + range: -0.3567 to 2.4248</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - by: Male</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - inference: unconditional</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Use `plot()` (`?adrftools::plot.effect_curve()`) to plot</span> <span style="font-style: italic;">the curve, `summary()`</span> <span style="font-style: italic;">(`?adrftools::summary.effect_curve()`) to test the curve,</span> <span style="font-style: italic;">or `{object}(values)` (`?adrftools::effect_curve-class()`)</span> <span style="font-style: italic;">to compute estimates.</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Test if ADRFs are flat</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">adrf1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Omnibus Curve Test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ───────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H₀: ADRF is flat (transformed) for values of logBLL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     between -0.3567 and 2.4248</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Male  P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0 &lt; 0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1 &lt; 0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ───────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Computed using the Imhof approximation</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Test if logit-transformed ADRFs are linear</span></span></span>
<span class="r-in"><span><span class="co"># (i.e., if ADRFs have sigmoid shape)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">adrf1</span>, hypothesis <span class="op">=</span> <span class="st">"linear"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Omnibus Curve Test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ───────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H₀: ADRF is linear (transformed) for values of logBLL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     between -0.3567 and 2.4248</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Male P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0  0.1644</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1  0.0189</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ───────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Computed using the Imhof approximation</span></span>
<span class="r-in"><span><span class="co"># summary(adrf1, hypothesis = ~logBLL) # same test</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">proj1</span> <span class="op">&lt;-</span> <span class="fu"><a href="curve_projection.html">curve_projection</a></span><span class="op">(</span><span class="va">adrf1</span>, <span class="st">"linear"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">adrf1</span>, proj <span class="op">=</span> <span class="va">proj1</span>, conf_level <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="summary.effect_curve-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Test if un-transformed ADRFs are linear</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">adrf1</span>, hypothesis <span class="op">=</span> <span class="st">"linear"</span>,</span></span>
<span class="r-in"><span>        transform <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Omnibus Curve Test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ───────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H₀: ADRF is linear for values of logBLL between</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     -0.3567 and 2.4248</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Male P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0  0.4736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1  0.0903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ───────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Computed using the Imhof approximation</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">proj2</span> <span class="op">&lt;-</span> <span class="fu"><a href="curve_projection.html">curve_projection</a></span><span class="op">(</span><span class="va">adrf1</span>, <span class="st">"linear"</span>,</span></span>
<span class="r-in"><span>                          transform <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">adrf1</span>, proj <span class="op">=</span> <span class="va">proj2</span>, conf_level <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="summary.effect_curve-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Test if ADRFs differ from each other by</span></span></span>
<span class="r-in"><span><span class="co">## testing if the ADRF contrast is 0</span></span></span>
<span class="r-in"><span><span class="fu"><a href="curve_contrast.html">curve_contrast</a></span><span class="op">(</span><span class="va">adrf1</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Omnibus Curve Test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ───────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H₀: ADRF contrast is 0 for values of logBLL between</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     -0.3567 and 2.4248</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Contrast  P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [Male = 1] - [Male = 0] &lt; 0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ───────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Computed using the Imhof approximation</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Noah Greifer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

